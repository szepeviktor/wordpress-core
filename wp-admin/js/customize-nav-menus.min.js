!function(t,e,i){"use strict";function s(t){return"nav_menu_item["+t+"]"}function r(e){return e=e||"",e=i("<div>").text(e).html(),(e=i.trim(e))||t.Menus.data.l10n.unnamed}wpNavMenu.originalInit=wpNavMenu.init,wpNavMenu.options.menuItemDepthPerLevel=20,wpNavMenu.options.sortableItems="> .customize-control-nav_menu_item",wpNavMenu.options.targetTolerance=10,wpNavMenu.init=function(){this.jQueryExtensions()},t.Menus=t.Menus||{},t.Menus.data={itemTypes:[],l10n:{},settingTransport:"refresh",phpIntMax:0,defaultSettingValues:{nav_menu:{},nav_menu_item:{}},locationSlugMappedToName:{}},"undefined"!=typeof _wpCustomizeNavMenusSettings&&i.extend(t.Menus.data,_wpCustomizeNavMenusSettings),t.Menus.generatePlaceholderAutoIncrementId=function(){return-Math.ceil(t.Menus.data.phpIntMax*Math.random())},t.Menus.AvailableItemModel=Backbone.Model.extend(i.extend({id:null},t.Menus.data.defaultSettingValues.nav_menu_item)),t.Menus.AvailableItemCollection=Backbone.Collection.extend({model:t.Menus.AvailableItemModel,sort_key:"order",comparator:function(t){return-t.get(this.sort_key)},sortByField:function(t){this.sort_key=t,this.sort()}}),t.Menus.availableMenuItems=new t.Menus.AvailableItemCollection(t.Menus.data.availableMenuItems),t.Menus.insertAutoDraftPost=function(s){var r,n=i.Deferred();return r=e.ajax.post("customize-nav-menus-insert-auto-draft",{"customize-menus-nonce":t.settings.nonce["customize-menus"],wp_customize:"on",customize_changeset_uuid:t.settings.changeset.uuid,params:s}),r.done(function(e){e.post_id&&(t("nav_menus_created_posts").set(t("nav_menus_created_posts").get().concat([e.post_id])),"page"===s.post_type&&(t.section.has("static_front_page")&&t.section("static_front_page").activate(),t.control.each(function(t){var i;"dropdown-pages"===t.params.type&&(i=t.container.find('select[name^="_customize-dropdown-pages-"]'),i.append(new Option(s.post_title,e.post_id)))})),n.resolve(e))}),r.fail(function(t){var e=t||"";"undefined"!=typeof t.message&&(e=t.message),console.error(e),n.rejectWith(e)}),n.promise()},t.Menus.AvailableMenuItemsPanelView=e.Backbone.View.extend({el:"#available-menu-items",events:{"input #menu-items-search":"debounceSearch","keyup #menu-items-search":"debounceSearch","focus .menu-item-tpl":"focus","click .menu-item-tpl":"_submit","click #custom-menu-item-submit":"_submitLink","keypress #custom-menu-item-name":"_submitLink","click .new-content-item .add-content":"_submitNew","keypress .create-item-input":"_submitNew",keydown:"keyboardAccessible"},selected:null,currentMenuControl:null,debounceSearch:null,$search:null,$clearResults:null,searchTerm:"",rendered:!1,pages:{},sectionContent:"",loading:!1,addingNew:!1,initialize:function(){var e=this;t.panel.has("nav_menus")&&(this.$search=i("#menu-items-search"),this.$clearResults=this.$el.find(".clear-results"),this.sectionContent=this.$el.find(".available-menu-items-list"),this.debounceSearch=_.debounce(e.search,500),_.bindAll(this,"close"),i("#customize-controls, .customize-section-back").on("click keydown",function(t){var s=i(t.target).is(".item-delete, .item-delete *"),r=i(t.target).is(".add-new-menu-item, .add-new-menu-item *");!i("body").hasClass("adding-menu-items")||s||r||e.close()}),this.$clearResults.on("click",function(){e.$search.val("").focus().trigger("keyup")}),this.$el.on("input","#custom-menu-item-name.invalid, #custom-menu-item-url.invalid",function(){i(this).removeClass("invalid")}),t.panel("nav_menus").container.bind("expanded",function(){e.rendered||(e.initList(),e.rendered=!0)}),this.sectionContent.scroll(function(){var t=e.$el.find(".accordion-section.open .available-menu-items-list").prop("scrollHeight"),s=e.$el.find(".accordion-section.open").height();if(!e.loading&&i(this).scrollTop()>.75*t-s){var r=i(this).data("type"),n=i(this).data("object");"search"===r?e.searchTerm&&e.doSearch(e.pages.search):e.loadItems([{type:r,object:n}])}}),t.previewer.bind("url",this.close),e.delegateEvents())},search:function(t){var e=i("#available-menu-items-search"),s=i("#available-menu-items .accordion-section").not(e);t&&this.searchTerm!==t.target.value&&(""===t.target.value||e.hasClass("open")?""===t.target.value&&(e.removeClass("open"),s.show(),this.$clearResults.removeClass("is-visible")):(s.fadeOut(100),e.find(".accordion-section-content").slideDown("fast"),e.addClass("open"),this.$clearResults.addClass("is-visible")),this.searchTerm=t.target.value,this.pages.search=1,this.doSearch(1))},doSearch:function(s){var r,n=this,a=i("#available-menu-items-search"),o=a.find(".accordion-section-content"),h=e.template("available-menu-item");if(n.currentRequest&&n.currentRequest.abort(),!(s<0)){if(s>1)a.addClass("loading-more"),o.attr("aria-busy","true"),e.a11y.speak(t.Menus.data.l10n.itemsLoadingMore);else if(""===n.searchTerm)return o.html(""),void e.a11y.speak("");a.addClass("loading"),n.loading=!0,r=t.previewer.query({excludeCustomizedSaved:!0}),_.extend(r,{"customize-menus-nonce":t.settings.nonce["customize-menus"],wp_customize:"on",search:n.searchTerm,page:s}),n.currentRequest=e.ajax.post("search-available-menu-items-customizer",r),n.currentRequest.done(function(i){var r;1===s&&o.empty(),a.removeClass("loading loading-more"),o.attr("aria-busy","false"),a.addClass("open"),n.loading=!1,r=new t.Menus.AvailableItemCollection(i.items),n.collection.add(r.models),r.each(function(t){o.append(h(t.attributes))}),20>r.length?n.pages.search=-1:n.pages.search=n.pages.search+1,r&&s>1?e.a11y.speak(t.Menus.data.l10n.itemsFoundMore.replace("%d",r.length)):r&&1===s&&e.a11y.speak(t.Menus.data.l10n.itemsFound.replace("%d",r.length))}),n.currentRequest.fail(function(t){t.message&&(o.empty().append(i('<li class="nothing-found"></li>').text(t.message)),e.a11y.speak(t.message)),n.pages.search=-1}),n.currentRequest.always(function(){a.removeClass("loading loading-more"),o.attr("aria-busy","false"),n.loading=!1,n.currentRequest=null})}},initList:function(){var e=this;_.each(t.Menus.data.itemTypes,function(t){e.pages[t.type+":"+t.object]=0}),e.loadItems(t.Menus.data.itemTypes)},loadItems:function(s,r){var n,a,o,h,d=this,c=[],l={};h=e.template("available-menu-item"),n=_.isString(s)&&_.isString(r)?[{type:s,object:r}]:s,_.each(n,function(t){var e,s=t.type+":"+t.object;-1!==d.pages[s]&&(e=i("#available-menu-items-"+t.type+"-"+t.object),e.find(".accordion-section-title").addClass("loading"),l[s]=e,c.push({object:t.object,type:t.type,page:d.pages[s]}))}),0!==c.length&&(d.loading=!0,a=t.previewer.query({excludeCustomizedSaved:!0}),_.extend(a,{"customize-menus-nonce":t.settings.nonce["customize-menus"],wp_customize:"on",item_types:c}),o=e.ajax.post("load-available-menu-items-customizer",a),o.done(function(e){var i;_.each(e.items,function(e,s){if(0===e.length)return 0===d.pages[s]&&l[s].find(".accordion-section-title").addClass("cannot-expand").removeClass("loading").find(".accordion-section-title > button").prop("tabIndex",-1),void(d.pages[s]=-1);"post_type:page"!==s||l[s].hasClass("open")||l[s].find(".accordion-section-title > button").click(),e=new t.Menus.AvailableItemCollection(e),d.collection.add(e.models),i=l[s].find(".available-menu-items-list"),e.each(function(t){i.append(h(t.attributes))}),d.pages[s]+=1})}),o.fail(function(t){"undefined"!=typeof console&&console.error&&console.error(t)}),o.always(function(){_.each(l,function(t){t.find(".accordion-section-title").removeClass("loading")}),d.loading=!1}))},itemSectionHeight:function(){var t,e,i,s,r;i=window.innerHeight,t=this.$el.find(".accordion-section:not( #available-menu-items-search ) .accordion-section-content"),e=this.$el.find('.accordion-section:not( #available-menu-items-search ) .available-menu-items-list:not(":only-child")'),s=46*(1+t.length)+14,120<(r=i-s)&&290>r&&(t.css("max-height",r),e.css("max-height",r-60))},select:function(t){this.selected=i(t),this.selected.siblings(".menu-item-tpl").removeClass("selected"),this.selected.addClass("selected")},focus:function(t){this.select(i(t.currentTarget))},_submit:function(t){"keypress"===t.type&&13!==t.which&&32!==t.which||this.submit(i(t.currentTarget))},submit:function(t){var e,s;t||(t=this.selected),t&&this.currentMenuControl&&(this.select(t),e=i(this.selected).data("menu-item-id"),(s=this.collection.findWhere({id:e}))&&(this.currentMenuControl.addItemToMenu(s.attributes),i(t).find(".menu-item-handle").addClass("item-added")))},_submitLink:function(t){"keypress"===t.type&&13!==t.which||this.submitLink()},submitLink:function(){var e,s,r=i("#custom-menu-item-name"),n=i("#custom-menu-item-url");if(this.currentMenuControl){if(s=/^((\w+:)?\/\/\w.*|\w+:(?!\/\/$)|\/|\?|#)/,""===r.val())return void r.addClass("invalid");if(!s.test(n.val()))return void n.addClass("invalid");e={title:r.val(),url:n.val(),type:"custom",type_label:t.Menus.data.l10n.custom_label,object:"custom"},this.currentMenuControl.addItemToMenu(e),n.val("http://"),r.val("")}},_submitNew:function(t){var e;"keypress"===t.type&&13!==t.which||this.addingNew||(e=i(t.target).closest(".accordion-section"),this.submitNew(e))},submitNew:function(s){var r,n=this,a=s.find(".create-item-input"),o=a.val(),h=s.find(".available-menu-items-list"),d=h.data("type"),c=h.data("object"),l=h.data("type_label");if(this.currentMenuControl&&"post_type"===d){if(""===i.trim(a.val()))return a.addClass("invalid"),void a.focus();a.removeClass("invalid"),s.find(".accordion-section-title").addClass("loading"),n.addingNew=!0,a.attr("disabled","disabled"),r=t.Menus.insertAutoDraftPost({post_title:o,post_type:c}),r.done(function(r){var o,h,u;o=new t.Menus.AvailableItemModel({id:"post-"+r.post_id,title:a.val(),type:d,type_label:l,object:c,object_id:r.post_id,url:r.url}),n.currentMenuControl.addItemToMenu(o.attributes),t.Menus.availableMenuItemsPanel.collection.add(o),h=s.find(".available-menu-items-list"),u=i(e.template("available-menu-item")(o.attributes)),u.find(".menu-item-handle:first").addClass("item-added"),h.prepend(u),h.scrollTop(),a.val("").removeAttr("disabled"),n.addingNew=!1,s.find(".accordion-section-title").removeClass("loading")})}},open:function(e){var s,r=this;this.currentMenuControl=e,this.itemSectionHeight(),t.section.has("publish_settings")&&t.section("publish_settings").collapse(),i("body").addClass("adding-menu-items"),s=function(){r.close(),i(this).off("click",s)},i("#customize-preview").on("click",s),_(this.currentMenuControl.getMenuItemControls()).each(function(t){t.collapseForm()}),this.$el.find(".selected").removeClass("selected"),this.$search.focus()},close:function(t){t=t||{},t.returnFocus&&this.currentMenuControl&&this.currentMenuControl.container.find(".add-new-menu-item").focus(),this.currentMenuControl=null,this.selected=null,i("body").removeClass("adding-menu-items"),i("#available-menu-items .menu-item-handle.item-added").removeClass("item-added"),this.$search.val("").trigger("keyup")},keyboardAccessible:function(t){var e=13===t.which,s=27===t.which,r=9===t.which&&t.shiftKey,n=i(t.target).is(this.$search);e&&!this.$search.val()||(n&&r?(this.currentMenuControl.container.find(".add-new-menu-item").focus(),t.preventDefault()):s&&this.close({returnFocus:!0}))}}),t.Menus.MenusPanel=t.Panel.extend({attachEvents:function(){t.Panel.prototype.attachEvents.call(this);var e=this,s=e.container.find(".panel-meta"),r=s.find(".customize-help-toggle"),n=s.find(".customize-panel-description"),a=i("#screen-options-wrap"),o=s.find(".customize-screen-options-toggle");o.on("click keydown",function(e){if(!t.utils.isKeydownButNotEnterEvent(e))return e.preventDefault(),n.not(":hidden")&&(n.slideUp("fast"),r.attr("aria-expanded","false")),"true"===o.attr("aria-expanded")?(o.attr("aria-expanded","false"),s.removeClass("open"),s.removeClass("active-menu-screen-options"),a.slideUp("fast")):(o.attr("aria-expanded","true"),s.addClass("open"),s.addClass("active-menu-screen-options"),a.slideDown("fast")),!1}),r.on("click keydown",function(e){t.utils.isKeydownButNotEnterEvent(e)||(e.preventDefault(),"true"===o.attr("aria-expanded")&&(o.attr("aria-expanded","false"),r.attr("aria-expanded","true"),s.addClass("open"),s.removeClass("active-menu-screen-options"),a.slideUp("fast"),n.slideDown("fast")))})},ready:function(){var i=this;i.container.find(".hide-column-tog").click(function(){i.saveManageColumnsState()}),t.section("menu_locations",function(i){i.headContainer.prepend(e.template("nav-menu-locations-header")(t.Menus.data))})},saveManageColumnsState:_.debounce(function(){var t=this;t._updateHiddenColumnsRequest&&t._updateHiddenColumnsRequest.abort(),t._updateHiddenColumnsRequest=e.ajax.post("hidden-columns",{hidden:t.hidden(),screenoptionnonce:i("#screenoptionnonce").val(),page:"nav-menus"}),t._updateHiddenColumnsRequest.always(function(){t._updateHiddenColumnsRequest=null})},2e3),checked:function(){},unchecked:function(){},hidden:function(){return i(".hide-column-tog").not(":checked").map(function(){var t=this.id;return t.substring(0,t.length-5)}).get().join(",")}}),t.Menus.MenuSection=t.Section.extend({initialize:function(e,s){var r=this;t.Section.prototype.initialize.call(r,e,s),r.deferred.initSortables=i.Deferred()},ready:function(){var e,s,r=this;if("undefined"==typeof r.params.menu_id)throw new Error("params.menu_id was not defined");r.active.validate=function(){return!!t.has(r.id)&&!!t(r.id).get()},r.populateControls(),r.navMenuLocationSettings={},r.assignedLocations=new t.Value([]),t.each(function(t,e){var i=e.match(/^nav_menu_locations\[(.+?)]/);i&&(r.navMenuLocationSettings[i[1]]=t,t.bind(function(){r.refreshAssignedLocations()}))}),r.assignedLocations.bind(function(t){r.updateAssignedLocationsInSectionTitle(t)}),r.refreshAssignedLocations(),t.bind("pane-contents-reflowed",function(){r.contentContainer.parent().length&&(r.container.find(".menu-item .menu-item-reorder-nav button").attr({tabindex:"0","aria-hidden":"false"}),r.container.find(".menu-item.move-up-disabled .menus-move-up").attr({tabindex:"-1","aria-hidden":"true"}),r.container.find(".menu-item.move-down-disabled .menus-move-down").attr({tabindex:"-1","aria-hidden":"true"}),r.container.find(".menu-item.move-left-disabled .menus-move-left").attr({tabindex:"-1","aria-hidden":"true"}),r.container.find(".menu-item.move-right-disabled .menus-move-right").attr({tabindex:"-1","aria-hidden":"true"}))}),s=function(){var t="field-"+i(this).val()+"-active";r.contentContainer.toggleClass(t,i(this).prop("checked"))},e=t.panel("nav_menus").contentContainer.find(".metabox-prefs:first").find(".hide-column-tog"),e.each(s),e.on("click",s)},populateControls:function(){var e,i,s,r,n,a,o,h,d,c=this;e=c.id+"[name]",a=t.control(e),a||(a=new t.controlConstructor.nav_menu_name(e,{type:"nav_menu_name",label:t.Menus.data.l10n.menuNameLabel,section:c.id,priority:0,settings:{"default":c.id}}),t.control.add(a),a.active.set(!0)),n=t.control(c.id),n||(n=new t.controlConstructor.nav_menu(c.id,{type:"nav_menu",section:c.id,priority:998,settings:{"default":c.id},menu_id:c.params.menu_id}),t.control.add(n),n.active.set(!0)),i=c.id+"[locations]",o=t.control(i),o||(o=new t.controlConstructor.nav_menu_locations(i,{section:c.id,priority:999,settings:{"default":c.id},menu_id:c.params.menu_id}),t.control.add(o.id,o),n.active.set(!0)),s=c.id+"[auto_add]",h=t.control(s),h||(h=new t.controlConstructor.nav_menu_auto_add(s,{type:"nav_menu_auto_add",label:"",section:c.id,priority:1e3,settings:{"default":c.id}}),t.control.add(h),h.active.set(!0)),r=c.id+"[delete]",(d=t.control(r))||(d=new t.Control(r,{section:c.id,priority:1001,templateId:"nav-menu-delete-button"}),t.control.add(d.id,d),d.active.set(!0),d.deferred.embedded.done(function(){d.container.find("button").on("click",function(){var e=c.params.menu_id;t.Menus.getMenuControl(e).setting.set(!1)})}))},refreshAssignedLocations:function(){var t=this,e=t.params.menu_id,i=[];_.each(t.navMenuLocationSettings,function(t,s){t()===e&&i.push(s)}),t.assignedLocations.set(i)},updateAssignedLocationsInSectionTitle:function(e){var s,r=this;s=r.container.find(".accordion-section-title:first"),s.find(".menu-in-location").remove(),_.each(e,function(e){var r,n;r=i('<span class="menu-in-location"></span>'),n=t.Menus.data.locationSlugMappedToName[e],r.text(t.Menus.data.l10n.menuLocation.replace("%s",n)),s.append(r)}),r.container.toggleClass("assigned-to-menu-location",0!==e.length)},onChangeExpanded:function(e,s){var r,n=this;e&&(wpNavMenu.menuList=n.contentContainer,wpNavMenu.targetList=wpNavMenu.menuList,i("#menu-to-edit").removeAttr("id"),wpNavMenu.menuList.attr("id","menu-to-edit").addClass("menu"),_.each(t.section(n.id).controls(),function(t){"nav_menu_item"===t.params.type&&t.actuallyEmbed()}),s.completeCallback&&(r=s.completeCallback),s.completeCallback=function(){"resolved"!==n.deferred.initSortables.state()&&(wpNavMenu.initSortables(),n.deferred.initSortables.resolve(wpNavMenu.menuList),t.control("nav_menu["+String(n.params.menu_id)+"]").reflowMenuItems()),_.isFunction(r)&&r()}),t.Section.prototype.onChangeExpanded.call(n,e,s)},highlightNewItemButton:function(){t.utils.highlightButton(this.contentContainer.find(".add-new-menu-item"),{delay:2e3})}}),t.Menus.createNavMenu=function(e){var s,n,a;return n=t.Menus.generatePlaceholderAutoIncrementId(),s="nav_menu["+String(n)+"]",a=t.create(s,s,{},{type:"nav_menu",transport:t.Menus.data.settingTransport,previewer:t.previewer}),a.set(i.extend({},t.Menus.data.defaultSettingValues.nav_menu,{name:e||""})),t.section.add(new t.Menus.MenuSection(s,{panel:"nav_menus",title:r(e),customizeAction:t.Menus.data.l10n.customizingMenus,priority:10,menu_id:n}))},t.Menus.NewMenuSection=t.Section.extend({attachEvents:function(){function i(){var e=0;return t.each(function(t){d.test(t.id)&&!1!==t.get()&&(e+=1)}),e}function s(){o.find(".add-new-menu-notice").prop("hidden",i()>0)}function r(t){d.test(t.id)&&(t.bind(s),s())}function n(t){d.test(t.id)&&(t.unbind(s),s())}var a=this,o=a.container,h=a.contentContainer,d=/^nav_menu\[/;a.headContainer.find(".accordion-section-title").replaceWith(e.template("nav-menu-create-menu-section-title")),o.on("click",".customize-add-menu-button",function(){a.expand()}),h.on("keydown",".menu-name-field",function(t){13===t.which&&a.submit()}),h.on("click","#customize-new-menu-submit",function(t){a.submit(),t.stopPropagation(),t.preventDefault()}),t.each(r),t.bind("add",r),t.bind("removed",n),s(),t.Section.prototype.attachEvents.apply(a,arguments)},ready:function(){this.populateControls()},populateControls:function(){var e,i,s,r,n,a,o=this;e=o.id+"[name]",r=t.control(e),r||(r=new t.controlConstructor.nav_menu_name(e,{label:t.Menus.data.l10n.menuNameLabel,description:t.Menus.data.l10n.newMenuNameDescription,section:o.id,priority:0}),t.control.add(r.id,r),r.active.set(!0)),i=o.id+"[locations]",n=t.control(i),n||(n=new t.controlConstructor.nav_menu_locations(i,{section:o.id,priority:1,menu_id:"",isCreating:!0}),t.control.add(i,n),n.active.set(!0)),s=o.id+"[submit]",(a=t.control(s))||(a=new t.Control(s,{section:o.id,priority:1,templateId:"nav-menu-submit-new-button"}),t.control.add(s,a),a.active.set(!0))},submit:function(){var s,r=this,n=r.contentContainer,a=n.find(".menu-name-field").first(),o=a.val();if(!o)return a.addClass("invalid"),void a.focus();s=t.Menus.createNavMenu(o),a.val(""),a.removeClass("invalid"),n.find(".assigned-menu-location input[type=checkbox]").each(function(){var e,r=i(this);r.prop("checked")&&(e=t("nav_menu_locations["+r.data("location-id")+"]"),e.set(s.params.menu_id),r.prop("checked",!1))}),e.a11y.speak(t.Menus.data.l10n.menuAdded),s.focus({completeCallback:function(){s.highlightNewItemButton()}})},selectDefaultLocation:function(e){var i=t.control(this.id+"[locations]"),s={};null!==e&&(s[e]=!0),i.setSelections(s)}}),t.Menus.MenuLocationControl=t.Control.extend({initialize:function(e,i){var s=this,r=e.match(/^nav_menu_locations\[(.+?)]/);s.themeLocation=r[1],t.Control.prototype.initialize.call(s,e,i)},ready:function(){var e=this,i=/^nav_menu\[(-?\d+)]/;e.setting.validate=function(t){return""===t?0:parseInt(t,10)},e.container.find(".create-menu").on("click",function(){var e=t.section("add_menu");e.selectDefaultLocation(this.dataset.locationId),e.focus()}),e.container.find(".edit-menu").on("click",function(){var i=e.setting();t.section("nav_menu["+i+"]").focus()}),e.setting.bind("change",function(){var t=0!==e.setting();e.container.find(".create-menu").toggleClass("hidden",t),e.container.find(".edit-menu").toggleClass("hidden",!t)}),t.bind("add",function(t){var s,n,a=t.id.match(i);a&&!1!==t()&&(n=a[1],s=new Option(r(t().name),n),e.container.find("select").append(s))}),t.bind("remove",function(t){var s,r=t.id.match(i);r&&(s=parseInt(r[1],10),e.setting()===s&&e.setting.set(""),e.container.find("option[value="+s+"]").remove())}),t.bind("change",function(t){var s,n=t.id.match(i);n&&(s=parseInt(n[1],10),!1===t()?(e.setting()===s&&e.setting.set(""),e.container.find("option[value="+s+"]").remove()):e.container.find("option[value="+s+"]").text(r(t().name)))})}}),t.Menus.MenuItemControl=t.Control.extend({initialize:function(e,s){var r=this;r.expanded=new t.Value(!1),r.expandedArgumentsQueue=[],r.expanded.bind(function(t){var e=r.expandedArgumentsQueue.shift();e=i.extend({},r.defaultExpandedArguments,e),r.onChangeExpanded(t,e)}),t.Control.prototype.initialize.call(r,e,s),r.active.validate=function(){var e=t.section(r.section());return!!e&&e.active()}},embed:function(){var e,i=this,s=i.section();s&&((e=t.section(s))&&e.expanded()||t.settings.autofocus.control===i.id)&&i.actuallyEmbed()},actuallyEmbed:function(){var t=this;"resolved"!==t.deferred.embedded.state()&&(t.renderContent(),t.deferred.embedded.resolve())},ready:function(){if("undefined"==typeof this.params.menu_item_id)throw new Error("params.menu_item_id was not defined");this._setupControlToggle(),this._setupReorderUI(),this._setupUpdateUI(),this._setupRemoveUI(),this._setupLinksUI(),this._setupTitleUI()},_setupControlToggle:function(){var e=this;this.container.find(".menu-item-handle").on("click",function(s){s.preventDefault(),s.stopPropagation();var r=e.getMenuControl(),n=i(s.target).is(".item-delete, .item-delete *"),a=i(s.target).is(".add-new-menu-item, .add-new-menu-item *");!i("body").hasClass("adding-menu-items")||n||a||t.Menus.availableMenuItemsPanel.close(),r.isReordering||r.isSorting||e.toggleForm()})},_setupReorderUI:function(){var t,s,r=this;t=e.template("menu-item-reorder-nav"),r.container.find(".item-controls").after(t),s=r.container.find(".menu-item-reorder-nav"),s.find(".menus-move-up, .menus-move-down, .menus-move-left, .menus-move-right").on("click",function(){var t=i(this);t.focus();var e=t.is(".menus-move-up"),s=t.is(".menus-move-down"),n=t.is(".menus-move-left"),a=t.is(".menus-move-right");e?r.moveUp():s?r.moveDown():n?r.moveLeft():a&&r.moveRight(),t.focus()})},_setupUpdateUI:function(){var e,i=this,s=i.setting();i.elements={},i.elements.url=new t.Element(i.container.find(".edit-menu-item-url")),i.elements.title=new t.Element(i.container.find(".edit-menu-item-title")),i.elements.attr_title=new t.Element(i.container.find(".edit-menu-item-attr-title")),i.elements.target=new t.Element(i.container.find(".edit-menu-item-target")),i.elements.classes=new t.Element(i.container.find(".edit-menu-item-classes")),i.elements.xfn=new t.Element(i.container.find(".edit-menu-item-xfn")),i.elements.description=new t.Element(i.container.find(".edit-menu-item-description")),_.each(i.elements,function(t,e){t.bind(function(s){t.element.is("input[type=checkbox]")&&(s=s?t.element.val():"");var r=i.setting();r&&r[e]!==s&&(r=_.clone(r),r[e]=s,i.setting.set(r))}),s&&("classes"!==e&&"xfn"!==e||!_.isArray(s[e])?t.set(s[e]):t.set(s[e].join(" ")))}),i.setting.bind(function(e,s){var r,n=i.params.menu_item_id,a=[],o=[];!1===e?(r=t.control("nav_menu["+String(s.nav_menu_term_id)+"]"),i.container.remove(),_.each(r.getMenuItemControls(),function(t){s.menu_item_parent===t.setting().menu_item_parent&&t.setting().position>s.position?a.push(t):t.setting().menu_item_parent===n&&o.push(t)}),_.each(a,function(t){var e=_.clone(t.setting());e.position+=o.length,t.setting.set(e)}),_.each(o,function(t,e){var i=_.clone(t.setting());i.position=s.position+e,i.menu_item_parent=s.menu_item_parent,t.setting.set(i)}),r.debouncedReflowMenuItems()):(_.each(e,function(t,s){i.elements[s]&&i.elements[s].set(e[s])}),i.container.find(".menu-item-data-parent-id").val(e.menu_item_parent),e.position===s.position&&e.menu_item_parent===s.menu_item_parent||i.getMenuControl().debouncedReflowMenuItems())}),e=function(){i.elements.url.element.toggleClass("invalid",i.setting.notifications.has("invalid_url"))},i.setting.notifications.bind("add",e),i.setting.notifications.bind("removed",e)},_setupRemoveUI:function(){var s,r=this;s=r.container.find(".item-delete"),s.on("click",function(){var s,n,a,o=!0;i("body").hasClass("adding-menu-items")||(o=!1),n=r.container.nextAll(".customize-control-nav_menu_item:visible").first(),a=r.container.prevAll(".customize-control-nav_menu_item:visible").first(),s=n.length?n.find(!1===o?".item-edit":".item-delete").first():a.length?a.find(!1===o?".item-edit":".item-delete").first():r.container.nextAll(".customize-control-nav_menu").find(".add-new-menu-item").first(),r.container.slideUp(function(){r.setting.set(!1),e.a11y.speak(t.Menus.data.l10n.itemDeleted),s.focus()}),r.setting.set(!1)})},_setupLinksUI:function(){var e;e=this.container.find("a.original-link"),e.on("click",function(e){e.preventDefault(),t.previewer.previewUrl(e.target.toString())})},_setupTitleUI:function(){var e,s=this;s.container.find(".edit-menu-item-title").on("blur",function(){i(this).val(i.trim(i(this).val()))}),e=s.container.find(".menu-item-title"),s.setting.bind(function(s){var r,n;s&&(r=i.trim(s.title),n=r||s.original_title||t.Menus.data.l10n.untitled,s._invalid&&(n=t.Menus.data.l10n.invalidTitleTpl.replace("%s",n)),r||s.original_title?e.text(n).removeClass("no-title"):e.text(n).addClass("no-title"))})},getDepth:function(){var e=this,i=e.setting(),s=0;if(!i)return 0;for(;i&&i.menu_item_parent&&(s+=1,e=t.control("nav_menu_item["+i.menu_item_parent+"]"));)i=e.setting();return s},renderContent:function(){var e,i=this,s=i.setting();i.params.title=s.title||"",i.params.depth=i.getDepth(),i.container.data("item-depth",i.params.depth),e=["menu-item","menu-item-depth-"+String(i.params.depth),"menu-item-"+s.object,"menu-item-edit-inactive"],s._invalid?(e.push("menu-item-invalid"),i.params.title=t.Menus.data.l10n.invalidTitleTpl.replace("%s",i.params.title)):"draft"===s.status&&(e.push("pending"),i.params.title=t.Menus.data.pendingTitleTpl.replace("%s",i.params.title)),i.params.el_classes=e.join(" "),i.params.item_type_label=s.type_label,i.params.item_type=s.type,i.params.url=s.url,i.params.target=s.target,i.params.attr_title=s.attr_title,i.params.classes=_.isArray(s.classes)?s.classes.join(" "):s.classes,i.params.attr_title=s.attr_title,i.params.xfn=s.xfn,i.params.description=s.description,i.params.parent=s.menu_item_parent,i.params.original_title=s.original_title||"",i.container.addClass(i.params.el_classes),t.Control.prototype.renderContent.call(i)},getMenuControl:function(){var e=this,i=e.setting();return i&&i.nav_menu_term_id?t.control("nav_menu["+i.nav_menu_term_id+"]"):null},expandControlSection:function(){var t=this.container.closest(".accordion-section");t.hasClass("open")||t.find(".accordion-section-title:first").trigger("click")},_toggleExpanded:t.Section.prototype._toggleExpanded,expand:t.Section.prototype.expand,expandForm:function(t){this.expand(t)},collapse:t.Section.prototype.collapse,collapseForm:function(t){this.collapse(t)},toggleForm:function(t,e){void 0===t&&(t=!this.expanded()),t?this.expand(e):this.collapse(e)},onChangeExpanded:function(e,i){var s,r,n,a=this;if(s=this.container,r=s.find(".menu-item-settings:first"),void 0===e&&(e=!r.is(":visible")),r.is(":visible")===e)return void(i&&i.completeCallback&&i.completeCallback());e?(t.control.each(function(t){a.params.type===t.params.type&&a!==t&&t.collapseForm()}),n=function(){s.removeClass("menu-item-edit-inactive").addClass("menu-item-edit-active"),a.container.trigger("expanded"),i&&i.completeCallback&&i.completeCallback()},s.find(".item-edit").attr("aria-expanded","true"),r.slideDown("fast",n),a.container.trigger("expand")):(n=function(){s.addClass("menu-item-edit-inactive").removeClass("menu-item-edit-active"),a.container.trigger("collapsed"),i&&i.completeCallback&&i.completeCallback()},a.container.trigger("collapse"),s.find(".item-edit").attr("aria-expanded","false"),r.slideUp("fast",n))},focus:function(e){e=e||{};var i,s=this,r=e.completeCallback;i=function(){s.expandControlSection(),e.completeCallback=function(){var t;t=s.container.find(".menu-item-settings").find("input, select, textarea, button, object, a[href], [tabindex]").filter(":visible"),t.first().focus(),r&&r()},s.expandForm(e)},t.section.has(s.section())?t.section(s.section()).expand({completeCallback:i}):i()},moveUp:function(){this._changePosition(-1),e.a11y.speak(t.Menus.data.l10n.movedUp)},moveDown:function(){this._changePosition(1),e.a11y.speak(t.Menus.data.l10n.movedDown)},moveLeft:function(){this._changeDepth(-1),e.a11y.speak(t.Menus.data.l10n.movedLeft)},moveRight:function(){this._changeDepth(1),e.a11y.speak(t.Menus.data.l10n.movedRight)},_changePosition:function(t){var e,s,r=this,n=_.clone(r.setting()),a=[];if(1!==t&&-1!==t)throw new Error("Offset changes by 1 are only supported.");if(r.setting()){if(_(r.getMenuControl().getMenuItemControls()).each(function(t){t.setting().menu_item_parent===n.menu_item_parent&&a.push(t.setting)}),a.sort(function(t,e){return t().position-e().position}),-1===(s=_.indexOf(a,r.setting)))throw new Error("Expected setting to be among siblings.");0===s&&t<0||s===a.length-1&&t>0||(e=a[s+t],e&&e.set(i.extend(_.clone(e()),{position:n.position})),n.position+=t,r.setting.set(n))}},_changeDepth:function(e){if(1!==e&&-1!==e)throw new Error("Offset changes by 1 are only supported.");var s,r,n,a=this,o=_.clone(a.setting()),h=[];if(_(a.getMenuControl().getMenuItemControls()).each(function(t){t.setting().menu_item_parent===o.menu_item_parent&&h.push(t)}),h.sort(function(t,e){return t.setting().position-e.setting().position}),-1===(s=_.indexOf(h,a)))throw new Error("Expected control to be among siblings.");if(-1===e){if(!o.menu_item_parent)return;n=t.control("nav_menu_item["+o.menu_item_parent+"]"),_(h).chain().slice(s).each(function(t,e){t.setting.set(i.extend({},t.setting(),{menu_item_parent:a.params.menu_item_id,position:e}))}),_(a.getMenuControl().getMenuItemControls()).each(function(t){var e,s;(s=t.setting().menu_item_parent===n.setting().menu_item_parent&&t.setting().position>n.setting().position)&&(e=_.clone(t.setting()),t.setting.set(i.extend(e,{position:e.position+1})))}),o.position=n.setting().position+1,o.menu_item_parent=n.setting().menu_item_parent,a.setting.set(o)}else if(1===e){if(0===s)return;r=h[s-1],o.menu_item_parent=r.params.menu_item_id,o.position=0,_(a.getMenuControl().getMenuItemControls()).each(function(t){t.setting().menu_item_parent===o.menu_item_parent&&(o.position=Math.max(o.position,t.setting().position))}),o.position+=1,a.setting.set(o)}}}),t.Menus.MenuNameControl=t.Control.extend({ready:function(){var e=this;if(e.setting){var i=e.setting();e.nameElement=new t.Element(e.container.find(".menu-name-field")),e.nameElement.bind(function(t){var i=e.setting();i&&i.name!==t&&(i=_.clone(i),i.name=t,e.setting.set(i))}),i&&e.nameElement.set(i.name),e.setting.bind(function(t){t&&e.nameElement.set(t.name)})}}}),t.Menus.MenuLocationsControl=t.Control.extend({ready:function(){var e=this;e.container.find(".assigned-menu-location").each(function(){var s=i(this),n=s.find("input[type=checkbox]"),a=new t.Element(n),o=t("nav_menu_locations["+n.data("location-id")+"]"),h=""===e.params.menu_id,d=h?_.noop:function(t){a.set(t)},c=h?_.noop:function(t){o.set(t?e.params.menu_id:0)},l=function(e){var i=t("nav_menu["+String(e)+"]");e&&i&&i()?s.find(".theme-location-set").show().find("span").text(r(i().name)):s.find(".theme-location-set").hide()};d(o.get()===e.params.menu_id),n.on("change",function(){c(this.checked)}),
o.bind(function(t){d(t===e.params.menu_id),l(t)}),l(o.get())})},setSelections:function(t){this.container.find(".menu-location").each(function(e,i){var s=i.dataset.locationId;i.checked=s in t&&t[s]})}}),t.Menus.MenuAutoAddControl=t.Control.extend({ready:function(){var e=this,i=e.setting();e.active.validate=function(){var i=t.section(e.section());return!!i&&i.active()},e.autoAddElement=new t.Element(e.container.find("input[type=checkbox].auto_add")),e.autoAddElement.bind(function(t){var i=e.setting();i&&i.name!==t&&(i=_.clone(i),i.auto_add=t,e.setting.set(i))}),i&&e.autoAddElement.set(i.auto_add),e.setting.bind(function(t){t&&e.autoAddElement.set(t.auto_add)})}}),t.Menus.MenuControl=t.Control.extend({ready:function(){var e,s,n,a=this,o=t.section(a.section()),h=a.params.menu_id,d=a.setting();if("undefined"==typeof this.params.menu_id)throw new Error("params.menu_id was not defined");a.active.validate=function(){return!!o&&o.active()},a.$controlSection=o.headContainer,a.$sectionContent=a.container.closest(".accordion-section-content"),this._setupModel(),t.section(a.section(),function(t){t.deferred.initSortables.done(function(t){a._setupSortable(t)})}),this._setupAddition(),this._setupTitle(),d&&(e=r(d.name),t.control.each(function(i){i.extended(t.controlConstructor.widget_form)&&"nav_menu"===i.params.widget_id_base&&(i.container.find(".nav-menu-widget-form-controls:first").show(),i.container.find(".nav-menu-widget-no-menus-message:first").hide(),n=i.container.find("select"),0===n.find("option[value="+String(h)+"]").length&&n.append(new Option(e,h)))}),s=i("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),s.find(".nav-menu-widget-form-controls:first").show(),s.find(".nav-menu-widget-no-menus-message:first").hide(),n=s.find(".widget-inside select:first"),0===n.find("option[value="+String(h)+"]").length&&n.append(new Option(e,h))),_.defer(function(){a.updateInvitationVisibility()})},_setupModel:function(){var e=this,i=e.params.menu_id;e.setting.bind(function(s){var n;!1===s?e._handleDeletion():(n=r(s.name),t.control.each(function(e){if(e.extended(t.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base){e.container.find("select").find("option[value="+String(i)+"]").text(n)}}))})},_setupSortable:function(e){var i=this;if(!e.is(i.$sectionContent))throw new Error("Unexpected menuList.");e.on("sortstart",function(){i.isSorting=!0}),e.on("sortstop",function(){setTimeout(function(){var e=i.$sectionContent.sortable("toArray"),s=[],r=0,n=10;i.isSorting=!1,i.$sectionContent.scrollLeft(0),_.each(e,function(e){var i,r,n;(n=e.match(/^customize-control-nav_menu_item-(-?\d+)$/,""))&&(i=parseInt(n[1],10),(r=t.control("nav_menu_item["+String(i)+"]"))&&s.push(r))}),_.each(s,function(t){if(!1!==t.setting()){var e=_.clone(t.setting());r+=1,n+=1,e.position=r,t.priority(n),e.menu_item_parent=parseInt(t.container.find(".menu-item-data-parent-id").val(),10),e.menu_item_parent||(e.menu_item_parent=0),t.setting.set(e)}})})}),i.isReordering=!1,this.container.find(".reorder-toggle").on("click",function(){i.toggleReordering(!i.isReordering)})},_setupAddition:function(){var e=this;this.container.find(".add-new-menu-item").on("click",function(s){e.$sectionContent.hasClass("reordering")||(i("body").hasClass("adding-menu-items")?(i(this).attr("aria-expanded","false"),t.Menus.availableMenuItemsPanel.close(),s.stopPropagation()):(i(this).attr("aria-expanded","true"),t.Menus.availableMenuItemsPanel.open(e)))})},_handleDeletion:function(){var s,r,n,a=this,o=a.params.menu_id,h=0;s=t.section(a.section()),r=function(){s.container.remove(),t.section.remove(s.id)},s&&s.expanded()?s.collapse({completeCallback:function(){r(),e.a11y.speak(t.Menus.data.l10n.menuDeleted),t.panel("nav_menus").focus()}}):r(),t.each(function(t){/^nav_menu\[/.test(t.id)&&!1!==t()&&(h+=1)}),t.control.each(function(e){if(e.extended(t.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base){var i=e.container.find("select");i.val()===String(o)&&i.prop("selectedIndex",0).trigger("change"),e.container.find(".nav-menu-widget-form-controls:first").toggle(0!==h),e.container.find(".nav-menu-widget-no-menus-message:first").toggle(0===h),e.container.find("option[value="+String(o)+"]").remove()}}),n=i("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),n.find(".nav-menu-widget-form-controls:first").toggle(0!==h),n.find(".nav-menu-widget-no-menus-message:first").toggle(0===h),n.find("option[value="+String(o)+"]").remove()},_setupTitle:function(){var e=this;e.setting.bind(function(s){if(s){var n=t.section(e.section()),a=e.params.menu_id,o=n.headContainer.find(".accordion-section-title"),h=n.contentContainer.find(".customize-section-title h3"),d=n.headContainer.find(".menu-in-location"),c=h.find(".customize-action"),l=r(s.name);o.text(l),d.length&&d.appendTo(o),h.text(l),c.length&&c.prependTo(h),t.control.each(function(t){/^nav_menu_locations\[/.test(t.id)&&t.container.find("option[value="+a+"]").text(l)}),n.contentContainer.find(".customize-control-checkbox input").each(function(){i(this).prop("checked")&&i(".current-menu-location-name-"+i(this).data("location-id")).text(l)})}})},toggleReordering:function(i){var s=this.container.find(".add-new-menu-item"),r=this.container.find(".reorder-toggle"),n=this.$sectionContent.find(".item-title");(i=Boolean(i))!==this.$sectionContent.hasClass("reordering")&&(this.isReordering=i,this.$sectionContent.toggleClass("reordering",i),this.$sectionContent.sortable(this.isReordering?"disable":"enable"),this.isReordering?(s.attr({tabindex:"-1","aria-hidden":"true"}),r.attr("aria-label",t.Menus.data.l10n.reorderLabelOff),e.a11y.speak(t.Menus.data.l10n.reorderModeOn),n.attr("aria-hidden","false")):(s.removeAttr("tabindex aria-hidden"),r.attr("aria-label",t.Menus.data.l10n.reorderLabelOn),e.a11y.speak(t.Menus.data.l10n.reorderModeOff),n.attr("aria-hidden","true")),i&&_(this.getMenuItemControls()).each(function(t){t.collapseForm()}))},getMenuItemControls:function(){var e=this,i=[],s=e.params.menu_id;return t.control.each(function(t){"nav_menu_item"===t.params.type&&t.setting()&&s===t.setting().nav_menu_term_id&&i.push(t)}),i},reflowMenuItems:function(){var t,e=this,i=e.getMenuItemControls();t=function(e){var i=[],s=e.currentParent;_.each(e.menuItemControls,function(t){s===t.setting().menu_item_parent&&i.push(t)}),i.sort(function(t,e){return t.setting().position-e.setting().position}),_.each(i,function(i){e.currentAbsolutePosition+=1,i.priority.set(e.currentAbsolutePosition),i.container.hasClass("menu-item-depth-"+String(e.currentDepth))||(_.each(i.container.prop("className").match(/menu-item-depth-\d+/g),function(t){i.container.removeClass(t)}),i.container.addClass("menu-item-depth-"+String(e.currentDepth))),i.container.data("item-depth",e.currentDepth),e.currentDepth+=1,e.currentParent=i.params.menu_item_id,t(e),e.currentDepth-=1,e.currentParent=s}),i.length&&(_(i).each(function(t){t.container.removeClass("move-up-disabled move-down-disabled move-left-disabled move-right-disabled"),0===e.currentDepth?t.container.addClass("move-left-disabled"):10===e.currentDepth&&t.container.addClass("move-right-disabled")}),i[0].container.addClass("move-up-disabled").addClass("move-right-disabled").toggleClass("move-down-disabled",1===i.length),i[i.length-1].container.addClass("move-down-disabled").toggleClass("move-up-disabled",1===i.length))},t({menuItemControls:i,currentParent:0,currentDepth:0,currentAbsolutePosition:0}),e.updateInvitationVisibility(i),e.container.find(".reorder-toggle").toggle(i.length>1)},debouncedReflowMenuItems:_.debounce(function(){this.reflowMenuItems.apply(this,arguments)},0),addItemToMenu:function(s){var r,n,a,o,h,d=this,c=0,l=10;return _.each(d.getMenuItemControls(),function(t){!1!==t.setting()&&(l=Math.max(l,t.priority()),0===t.setting().menu_item_parent&&(c=Math.max(c,t.setting().position)))}),c+=1,l+=1,s=i.extend({},t.Menus.data.defaultSettingValues.nav_menu_item,s,{nav_menu_term_id:d.params.menu_id,original_title:s.title,position:c}),delete s.id,h=t.Menus.generatePlaceholderAutoIncrementId(),r="nav_menu_item["+String(h)+"]",n={type:"nav_menu_item",transport:t.Menus.data.settingTransport,previewer:t.previewer},a=t.create(r,r,{},n),a.set(s),o=new t.controlConstructor.nav_menu_item(r,{type:"nav_menu_item",section:d.id,priority:l,settings:{"default":r},menu_item_id:h}),t.control.add(o),a.preview(),d.debouncedReflowMenuItems(),e.a11y.speak(t.Menus.data.l10n.itemAdded),o},updateInvitationVisibility:function(t){var e=t||this.getMenuItemControls();this.container.find(".new-menu-item-invitation").toggle(0===e.length)}}),t.Menus.NewMenuControl=t.Control.extend({initialize:function(){"undefined"!=typeof console&&console.warn&&console.warn("[DEPRECATED] wp.customize.NewMenuControl will be removed. Please use wp.customize.Menus.createNavMenu() instead."),t.Control.prototype.initialize.apply(this,arguments)},ready:function(){this._bindHandlers()},_bindHandlers:function(){var t=this,e=i("#customize-control-new_menu_name input"),s=i("#create-new-menu-submit");e.on("keydown",function(e){13===e.which&&t.submit()}),s.on("click",function(e){t.submit(),e.stopPropagation(),e.preventDefault()})},submit:function(){var i,s=this,r=s.container.closest(".accordion-section-new-menu"),n=r.find(".menu-name-field").first(),a=n.val();if(!a)return n.addClass("invalid"),void n.focus();i=t.Menus.createNavMenu(a),n.val(""),n.removeClass("invalid"),e.a11y.speak(t.Menus.data.l10n.menuAdded),i.focus()}}),i.extend(t.controlConstructor,{nav_menu_location:t.Menus.MenuLocationControl,nav_menu_item:t.Menus.MenuItemControl,nav_menu:t.Menus.MenuControl,nav_menu_name:t.Menus.MenuNameControl,new_menu:t.Menus.NewMenuControl,nav_menu_locations:t.Menus.MenuLocationsControl,nav_menu_auto_add:t.Menus.MenuAutoAddControl}),i.extend(t.panelConstructor,{nav_menus:t.Menus.MenusPanel}),i.extend(t.sectionConstructor,{nav_menu:t.Menus.MenuSection,new_menu:t.Menus.NewMenuSection}),t.bind("ready",function(){t.Menus.availableMenuItemsPanel=new t.Menus.AvailableMenuItemsPanelView({collection:t.Menus.availableMenuItems}),t.bind("saved",function(e){(e.nav_menu_updates||e.nav_menu_item_updates)&&t.Menus.applySavedData(e)}),t.state("changesetStatus").bind(function(e){"publish"===e&&(t("nav_menus_created_posts")._value=[])}),t.previewer.bind("focus-nav-menu-item-control",t.Menus.focusMenuItemControl)}),t.Menus.applySavedData=function(s){var r={},n={};_(s.nav_menu_updates).each(function(s){var n,a,o,h,d,c,l,u,p,m,g,f,v;if("inserted"===s.status){if(!s.previous_term_id)throw new Error("Expected previous_term_id");if(!s.term_id)throw new Error("Expected term_id");if(n="nav_menu["+String(s.previous_term_id)+"]",!t.has(n))throw new Error("Expected setting to exist: "+n);if(h=t(n),!t.section.has(n))throw new Error("Expected control to exist: "+n);if(u=t.section(n),!(l=h.get()))throw new Error("Did not expect setting to be empty (deleted).");l=i.extend(_.clone(l),s.saved_value),r[s.previous_term_id]=s.term_id,a="nav_menu["+String(s.term_id)+"]",d=t.create(a,a,l,{type:"nav_menu",transport:t.Menus.data.settingTransport,previewer:t.previewer}),v=u.expanded(),v&&u.collapse(),p=new t.Menus.MenuSection(a,{panel:"nav_menus",title:l.name,customizeAction:t.Menus.data.l10n.customizingMenus,type:"nav_menu",priority:u.priority.get(),menu_id:s.term_id}),t.section.add(p),t.control.each(function(e){if(e.extended(t.controlConstructor.widget_form)&&"nav_menu"===e.params.widget_id_base){var i,r,n;i=e.container.find("select"),r=i.find("option[value="+String(s.previous_term_id)+"]"),n=i.find("option[value="+String(s.term_id)+"]"),n.prop("selected",r.prop("selected")),r.remove()}}),h.callbacks.disable(),h.set(!1),h.preview(),d.preview(),h._dirty=!1,u.container.remove(),t.section.remove(n),f=0,t.each(function(t){/^nav_menu\[/.test(t.id)&&!1!==t()&&(f+=1)}),g=i("#available-widgets-list .widget-tpl:has( input.id_base[ value=nav_menu ] )"),g.find(".nav-menu-widget-form-controls:first").toggle(0!==f),g.find(".nav-menu-widget-no-menus-message:first").toggle(0===f),g.find("option[value="+String(s.previous_term_id)+"]").remove(),e.customize.control.each(function(t){/^nav_menu_locations\[/.test(t.id)&&t.container.find("option[value="+String(s.previous_term_id)+"]").remove()}),t.each(function(e){var i=t.state("saved").get();/^nav_menu_locations\[/.test(e.id)&&e.get()===s.previous_term_id&&(e.set(s.term_id),e._dirty=!1,t.state("saved").set(i),e.preview())}),v&&p.expand()}else if("updated"===s.status){if(o="nav_menu["+String(s.term_id)+"]",!t.has(o))throw new Error("Expected setting to exist: "+o);c=t(o),_.isEqual(s.saved_value,c.get())||(m=t.state("saved").get(),c.set(s.saved_value),c._dirty=!1,t.state("saved").set(m))}}),_(s.nav_menu_item_updates).each(function(t){t.previous_post_id&&(n[t.previous_post_id]=t.post_id)}),_(s.nav_menu_item_updates).each(function(e){var i,s,a,o,h,d,c;if("inserted"===e.status){if(!e.previous_post_id)throw new Error("Expected previous_post_id");if(!e.post_id)throw new Error("Expected post_id");if(i="nav_menu_item["+String(e.previous_post_id)+"]",!t.has(i))throw new Error("Expected setting to exist: "+i);if(a=t(i),!t.control.has(i))throw new Error("Expected control to exist: "+i);if(d=t.control(i),!(h=a.get()))throw new Error("Did not expect setting to be empty (deleted).");if(h=_.clone(h),h.menu_item_parent<0){if(!n[h.menu_item_parent])throw new Error("inserted ID for menu_item_parent not available");h.menu_item_parent=n[h.menu_item_parent]}r[h.nav_menu_term_id]&&(h.nav_menu_term_id=r[h.nav_menu_term_id]),s="nav_menu_item["+String(e.post_id)+"]",o=t.create(s,s,h,{type:"nav_menu_item",transport:t.Menus.data.settingTransport,previewer:t.previewer}),c=new t.controlConstructor.nav_menu_item(s,{type:"nav_menu_item",menu_id:e.post_id,section:"nav_menu["+String(h.nav_menu_term_id)+"]",priority:d.priority.get(),settings:{"default":s},menu_item_id:e.post_id}),d.container.remove(),t.control.remove(i),t.control.add(c),a.callbacks.disable(),a.set(!1),a.preview(),o.preview(),a._dirty=!1,c.container.toggleClass("menu-item-edit-inactive",d.container.hasClass("menu-item-edit-inactive"))}}),_.each(s.widget_nav_menu_updates,function(e,i){var s=t(i);s&&(s._value=e,s.preview())})},t.Menus.focusMenuItemControl=function(e){var i=t.Menus.getMenuItemControl(e);i&&i.focus()},t.Menus.getMenuControl=function(e){return t.control("nav_menu["+e+"]")},t.Menus.getMenuItemControl=function(e){return t.control(s(e))}}(wp.customize,wp,jQuery);