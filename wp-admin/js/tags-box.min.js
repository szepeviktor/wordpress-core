!function(t){var e=window.tagsSuggestL10n&&window.tagsSuggestL10n.tagDelimiter||",";window.array_unique_noempty=function(e){var i=[];return t.each(e,function(e,s){(s=t.trim(s))&&-1===t.inArray(s,i)&&i.push(s)}),i},window.tagBox={clean:function(t){return","!==e&&(t=t.replace(new RegExp(e,"g"),",")),t=t.replace(/\s*,\s*/g,",").replace(/,+/g,",").replace(/[,\s]+$/,"").replace(/^[,\s]+/,""),","!==e&&(t=t.replace(/,/g,e)),t},parseTags:function(i){var s=i.id,r=s.split("-check-num-")[1],n=t(i).closest(".tagsdiv"),a=n.find(".the-tags"),o=a.val().split(e),h=[];return delete o[r],t.each(o,function(e,i){(i=t.trim(i))&&h.push(i)}),a.val(this.clean(h.join(e))),this.quickClicks(n),!1},quickClicks:function(i){var s,r,n=t(".the-tags",i),a=t(".tagchecklist",i),o=t(i).attr("id");n.length&&(r=n.prop("disabled"),s=n.val().split(e),a.empty(),t.each(s,function(e,i){var s,n;(i=t.trim(i))&&(s=t("<li />").text(i),r||(n=t('<button type="button" id="'+o+"-check-num-"+e+'" class="ntdelbutton"><span class="remove-tag-icon" aria-hidden="true"></span><span class="screen-reader-text">'+window.tagsSuggestL10n.removeTerm+" "+s.html()+"</span></button>"),n.on("click keypress",function(e){"click"!==e.type&&13!==e.keyCode&&32!==e.keyCode||(13!==e.keyCode&&32!==e.keyCode||t(this).closest(".tagsdiv").find("input.newtag").focus(),tagBox.userAction="remove",tagBox.parseTags(this))}),s.prepend("&nbsp;").prepend(n)),a.append(s))}),tagBox.screenReadersMessage())},flushTags:function(i,s,r){var n,a,o,h=t(".the-tags",i),d=t("input.newtag",i);return s=s||!1,void 0!==(o=s?t(s).text():d.val())&&""!==o&&(n=h.val(),a=n?n+e+o:o,a=this.clean(a),a=array_unique_noempty(a.split(e)).join(e),h.val(a),this.quickClicks(i),s||d.val(""),void 0===r&&d.focus(),!1)},get:function(e){var i=e.substr(e.indexOf("-")+1);t.post(ajaxurl,{action:"get-tagcloud",tax:i},function(s,r){0!==s&&"success"==r&&(s=t('<div id="tagcloud-'+i+'" class="the-tagcloud">'+s+"</div>"),t("a",s).click(function(){return tagBox.userAction="add",tagBox.flushTags(t("#"+i),this),!1}),t("#"+e).after(s))})},userAction:"",screenReadersMessage:function(){var t;switch(this.userAction){case"remove":t=window.tagsSuggestL10n.termRemoved;break;case"add":t=window.tagsSuggestL10n.termAdded;break;default:return}window.wp.a11y.speak(t,"assertive")},init:function(){var e=t("div.ajaxtag");t(".tagsdiv").each(function(){tagBox.quickClicks(this)}),t(".tagadd",e).click(function(){tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv"))}),t("input.newtag",e).keypress(function(e){13==e.which&&(tagBox.userAction="add",tagBox.flushTags(t(this).closest(".tagsdiv")),e.preventDefault(),e.stopPropagation())}).keypress(function(t){13==t.which&&(t.preventDefault(),t.stopPropagation())}).each(function(e,i){t(i).wpTagsSuggest()}),t("#post").submit(function(){t("div.tagsdiv").each(function(){tagBox.flushTags(this,!1,1)})}),t(".tagcloud-link").click(function(){tagBox.get(t(this).attr("id")),t(this).attr("aria-expanded","true").unbind().click(function(){t(this).attr("aria-expanded","false"===t(this).attr("aria-expanded")?"true":"false").siblings(".the-tagcloud").toggle()})})}}}(jQuery);