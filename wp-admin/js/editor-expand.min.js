!function(t,e,i){"use strict";var s=e(t),r=e(document),n=e("#wpadminbar"),a=e("#wpfooter");e(function(){function i(){var t=k.value.length;m&&!m.isHidden()||(m||"tinymce"!==R)&&(t<D?V():parseInt(k.style.height,10)<k.scrollHeight&&(k.style.height=Math.ceil(k.scrollHeight)+"px",h()),D=t)}function o(){var t=s.width();J={windowHeight:s.height(),windowWidth:t,adminBarHeight:t>600?n.outerHeight():0,toolsHeight:y.outerHeight()||0,menuBarHeight:M.outerHeight()||0,visualTopHeight:w.outerHeight()||0,textTopHeight:x.outerHeight()||0,bottomHeight:U.outerHeight()||0,statusBarHeight:z.outerHeight()||0,sideSortablesHeight:O.height()||0},J.menuBarHeight<3&&(J.menuBarHeight=0)}function h(e){if(!S||!S.settings.visible){var n,h,d,c,l,u,p,g,f,_=s.scrollTop(),k=e&&e.type,D="scroll"!==k,E=m&&!m.isHidden(),C=I,Q=q.offset().top,R=v.width();!D&&J.windowHeight||o(),E||"resize"!==k||i(),E?(n=w,h=b,p=J.visualTopHeight):(n=x,h=A,p=J.textTopHeight),(E||n.length)&&(u=n.parent().offset().top,g=h.offset().top,f=h.outerHeight(),l=E?I+p:I+20,l=f>l+5,l?((!T||D)&&_>=u-J.toolsHeight-J.adminBarHeight&&_<=u-J.toolsHeight-J.adminBarHeight+f-C?(T=!0,y.css({position:"fixed",top:J.adminBarHeight,width:R}),E&&M.length&&M.css({position:"fixed",top:J.adminBarHeight+J.toolsHeight,width:R-2-(E?0:n.outerWidth()-n.width())}),n.css({position:"fixed",top:J.adminBarHeight+J.toolsHeight+J.menuBarHeight,width:R-2-(E?0:n.outerWidth()-n.width())})):(T||D)&&(_<=u-J.toolsHeight-J.adminBarHeight?(T=!1,y.css({position:"absolute",top:0,width:R}),E&&M.length&&M.css({position:"absolute",top:0,width:R-2}),n.css({position:"absolute",top:J.menuBarHeight,width:R-2-(E?0:n.outerWidth()-n.width())})):_>=u-J.toolsHeight-J.adminBarHeight+f-C&&(T=!1,y.css({position:"absolute",top:f-C,width:R}),E&&M.length&&M.css({position:"absolute",top:f-C,width:R-2}),n.css({position:"absolute",top:f-C+J.menuBarHeight,width:R-2-(E?0:n.outerWidth()-n.width())}))),(!L||D&&N)&&_+J.windowHeight<=g+f+J.bottomHeight+J.statusBarHeight+1?e&&e.deltaHeight>0&&e.deltaHeight<100?t.scrollBy(0,e.deltaHeight):E&&N&&(L=!0,z.css({position:"fixed",bottom:J.bottomHeight,visibility:"",width:R-2}),U.css({position:"fixed",bottom:0,width:R})):(!N&&L||(L||D)&&_+J.windowHeight>g+f+J.bottomHeight+J.statusBarHeight-1)&&(L=!1,z.attr("style",N?"":"visibility: hidden;"),U.attr("style",""))):D&&(y.css({position:"absolute",top:0,width:R}),E&&M.length&&M.css({position:"absolute",top:0,width:R-2}),n.css({position:"absolute",top:J.menuBarHeight,width:R-2-(E?0:n.outerWidth()-n.width())}),z.attr("style",N?"":"visibility: hidden;"),U.attr("style","")),j.width()<300&&J.windowWidth>600&&r.height()>O.height()+Q+120&&J.windowHeight<f?(J.sideSortablesHeight+H+F>J.windowHeight||P||W?_+H<=Q?(O.attr("style",""),P=W=!1):_>B?P?(P=!1,d=O.offset().top-J.adminBarHeight,c=a.offset().top,c<d+J.sideSortablesHeight+F&&(d=c-J.sideSortablesHeight-12),O.css({position:"absolute",top:d,bottom:""})):!W&&J.sideSortablesHeight+O.offset().top+F<_+J.windowHeight&&(W=!0,O.css({position:"fixed",top:"auto",bottom:F})):_<B&&(W?(W=!1,d=O.offset().top-F,c=a.offset().top,c<d+J.sideSortablesHeight+F&&(d=c-J.sideSortablesHeight-12),O.css({position:"absolute",top:d,bottom:""})):!P&&O.offset().top>=_+H&&(P=!0,O.css({position:"fixed",top:H,bottom:""}))):(_>=Q-H?O.css({position:"fixed",top:H}):O.attr("style",""),P=W=!1),B=_):(O.attr("style",""),P=W=!1),D&&(v.css({paddingTop:J.toolsHeight}),E?b.css({paddingTop:J.visualTopHeight+J.menuBarHeight}):A.css({marginTop:J.textTopHeight})))}}function d(){i(),h()}function c(t){for(var e=1;e<6;e++)setTimeout(t,500*e)}function l(){clearTimeout(g),g=setTimeout(h,100)}function u(){t.pageYOffset&&t.pageYOffset>Q&&t.scrollTo(t.pageXOffset,0),f.addClass("wp-editor-expand"),s.on("scroll.editor-expand resize.editor-expand",function(t){h(t.type),l()}),r.on("wp-collapse-menu.editor-expand postboxes-columnchange.editor-expand editor-classchange.editor-expand",h).on("postbox-toggled.editor-expand postbox-moved.editor-expand",function(){!P&&!W&&t.pageYOffset>H&&(W=!0,t.scrollBy(0,-1),h(),t.scrollBy(0,1)),h()}).on("wp-window-resized.editor-expand",function(){m&&!m.isHidden()?m.execCommand("wpAutoResize"):i()}),A.on("focus.editor-expand input.editor-expand propertychange.editor-expand",i),E(),S&&S.pubsub.subscribe("hidden",d),m&&(m.settings.wp_autoresize_on=!0,m.execCommand("wpAutoResizeOn"),m.isHidden()||m.execCommand("wpAutoResize")),m&&!m.isHidden()||i(),h(),r.trigger("editor-expand-on")}function p(){var i=parseInt(t.getUserSetting("ed_size",300),10);i<50?i=50:i>5e3&&(i=5e3),t.pageYOffset&&t.pageYOffset>Q&&t.scrollTo(t.pageXOffset,0),f.removeClass("wp-editor-expand"),s.off(".editor-expand"),r.off(".editor-expand"),A.off(".editor-expand"),C(),S&&S.pubsub.unsubscribe("hidden",d),e.each([w,x,y,M,U,z,v,b,A,O],function(t,e){e&&e.attr("style","")}),T=L=P=W=!1,m&&(m.settings.wp_autoresize_on=!1,m.execCommand("wpAutoResizeOff"),m.isHidden()||(A.hide(),i&&m.theme.resizeTo(null,i))),i&&A.height(i),r.trigger("editor-expand-off")}var m,g,f=e("#postdivrich"),v=e("#wp-content-wrap"),y=e("#wp-content-editor-tools"),w=e(),b=e(),x=e("#ed_toolbar"),A=e("#content"),k=A[0],D=0,U=e("#post-status-info"),M=e(),z=e(),O=e("#side-sortables"),j=e("#postbox-container-1"),q=e("#post-body"),S=t.wp.editor&&t.wp.editor.fullscreen,E=function(){},C=function(){},T=!1,L=!1,P=!1,W=!1,B=0,Q=130,H=56,F=20,I=300,R=v.hasClass("tmce-active")?"tinymce":"html",N=!!parseInt(t.getUserSetting("hidetb"),10),J={windowHeight:0,windowWidth:0,adminBarHeight:0,toolsHeight:0,menuBarHeight:0,visualTopHeight:0,textTopHeight:0,bottomHeight:0,statusBarHeight:0,sideSortablesHeight:0},V=t._.throttle(function(){var e=t.scrollX||document.documentElement.scrollLeft,i=t.scrollY||document.documentElement.scrollTop,s=parseInt(k.style.height,10);k.style.height=I+"px",k.scrollHeight>I&&(k.style.height=k.scrollHeight+"px"),void 0!==e&&t.scrollTo(e,i),k.scrollHeight<s&&h()},300);r.on("tinymce-editor-init.editor-expand",function(r,n){function a(){var t,e,i,s=n.selection.getNode();if(n.wp&&n.wp.getView&&(e=n.wp.getView(s)))i=e.getBoundingClientRect();else{t=n.selection.getRng();try{i=t.getClientRects()[0]}catch(r){}i||(i=s.getBoundingClientRect())}return!!i.height&&i}function o(t){var e=t.keyCode;e<=47&&e!==y.SPACEBAR&&e!==y.ENTER&&e!==y.DELETE&&e!==y.BACKSPACE&&e!==y.UP&&e!==y.LEFT&&e!==y.DOWN&&e!==y.UP||e>=91&&e<=93||e>=112&&e<=123||144===e||145===e||d(e)}function d(e){var i,s,r,o,h=a();h&&(i=h.top+n.iframeElement.getBoundingClientRect().top,s=i+h.height,i-=50,s+=50,r=J.adminBarHeight+J.toolsHeight+J.menuBarHeight+J.visualTopHeight,(o=J.windowHeight-(N?J.bottomHeight+J.statusBarHeight:0))-r<h.height||(i<r&&(e===y.UP||e===y.LEFT||e===y.BACKSPACE)?t.scrollTo(t.pageXOffset,i+t.pageYOffset-r):s>o&&t.scrollTo(t.pageXOffset,s+t.pageYOffset-o)))}function l(t){t.state||h()}function u(){s.on("scroll.mce-float-panels",x),setTimeout(function(){n.execCommand("wpAutoResize"),h()},300)}function p(){s.off("scroll.mce-float-panels"),setTimeout(function(){var e=v.offset().top;t.pageYOffset>e&&t.scrollTo(t.pageXOffset,e-J.adminBarHeight),i(),h()},100),h()}function g(){N=!N}var y=t.tinymce.util.VK,x=_.debounce(function(){!e(".mce-floatpanel:hover").length&&t.tinymce.ui.FloatPanel.hideAll(),e(".mce-tooltip").hide()},1e3,!0);"content"===n.id&&(m=n,n.settings.autoresize_min_height=I,w=v.find(".mce-toolbar-grp"),b=v.find(".mce-edit-area"),z=v.find(".mce-statusbar"),M=v.find(".mce-menubar"),E=function(){n.on("keyup",o),n.on("show",u),n.on("hide",p),n.on("wp-toolbar-toggle",g),n.on("setcontent wp-autoresize wp-toolbar-toggle",h),n.on("undo redo",d),n.on("FullscreenStateChanged",l),s.off("scroll.mce-float-panels").on("scroll.mce-float-panels",x)},C=function(){n.off("keyup",o),n.off("show",u),n.off("hide",p),n.off("wp-toolbar-toggle",g),n.off("setcontent wp-autoresize wp-toolbar-toggle",h),n.off("undo redo",d),n.off("FullscreenStateChanged",l),s.off("scroll.mce-float-panels")},f.hasClass("wp-editor-expand")&&(E(),c(h)))}),f.hasClass("wp-editor-expand")&&(u(),v.hasClass("html-active")&&c(function(){h(),i()})),e("#adv-settings .editor-expand").show(),e("#editor-expand-toggle").on("change.editor-expand",function(){e(this).prop("checked")?(u(),t.setUserSetting("editor_expand","on")):(p(),t.setUserSetting("editor_expand","off"))}),t.editorExpand={on:u,off:p}}),e(function(){function i(){D=T.offset(),D.right=D.left+T.outerWidth(),D.bottom=D.top+T.outerHeight()}function o(){R||(R=!0,r.trigger("dfw-activate"),P.on("keydown.focus-shortcut",b))}function h(){R&&(l(),R=!1,r.trigger("dfw-deactivate"),P.off("keydown.focus-shortcut"))}function d(){return R}function c(){!N&&R&&(N=!0,P.on("keydown.focus",m),L.add(P).on("blur.focus",f),m(),t.setUserSetting("post_dfw","on"),r.trigger("dfw-on"))}function l(){N&&(N=!1,L.add(P).off(".focus"),g(),T.off(".focus"),t.setUserSetting("post_dfw","off"),r.trigger("dfw-off"))}function u(){N?l():c()}function p(){return N}function m(e){var r,n=e&&e.keyCode;if(t.navigator.platform&&(r=t.navigator.platform.indexOf("Mac")>-1),27===n||87===n&&e.altKey&&(!r&&e.shiftKey||r&&e.ctrlKey))return void g(e);e&&(e.metaKey||e.ctrlKey&&!e.altKey||e.altKey&&e.shiftKey||n&&(n<=47&&8!==n&&13!==n&&32!==n&&46!==n||n>=91&&n<=93||n>=112&&n<=135||n>=144&&n<=150||n>=224))||(x||(x=!0,clearTimeout(q),q=setTimeout(function(){W.show()},600),T.css("z-index",9998),W.on("mouseenter.focus",function(){i(),s.on("scroll.focus",function(){var e=t.pageYOffset;O&&z&&O!==e&&(z<D.top-$||z>D.bottom+$)&&g(),O=e})}).on("mouseleave.focus",function(){U=M=null,J=V=0,s.off("scroll.focus")}).on("mousemove.focus",function(e){var i=e.clientX,s=e.clientY,r=t.pageYOffset,n=t.pageXOffset;if(U&&M&&(i!==U||s!==M))if(s<=M&&s<D.top-r||s>=M&&s>D.bottom-r||i<=U&&i<D.left-n||i>=U&&i>D.right-n){if(J+=Math.abs(U-i),V+=Math.abs(M-s),(s<=D.top-$-r||s>=D.bottom+$-r||i<=D.left-$-n||i>=D.right+$-n)&&(J>10||V>10))return g(),U=M=null,void(J=V=0)}else J=V=0;U=i,M=s}).on("touchstart.focus",function(t){t.preventDefault(),g()}),T.off("mouseenter.focus"),j&&(clearTimeout(j),j=null),E.addClass("focus-on").removeClass("focus-off")),_(),y())}function g(t){x&&(x=!1,clearTimeout(q),q=setTimeout(function(){W.hide()},200),T.css("z-index",""),W.off("mouseenter.focus mouseleave.focus mousemove.focus touchstart.focus"),void 0===t&&T.on("mouseenter.focus",function(){(e.contains(T.get(0),document.activeElement)||S)&&m()}),j=setTimeout(function(){j=null,T.off("mouseenter.focus")},1e3),E.addClass("focus-off").removeClass("focus-on")),v(),w()}function f(){setTimeout(function(){function t(t){return e.contains(t.get(0),document.activeElement)}var i=document.activeElement.compareDocumentPosition(T.get(0));2!==i&&4!==i||!(t(H)||t(C)||t(a))||g()},0)}function _(){!A&&x&&(A=!0,n.on("mouseenter.focus",function(){n.addClass("focus-off")}).on("mouseleave.focus",function(){n.removeClass("focus-off")}))}function v(){A&&(A=!1,n.off(".focus"))}function y(){k||!x||B.find(":focus").length||(k=!0,B.stop().fadeTo("fast",.3).on("mouseenter.focus",w).off("mouseleave.focus"),Q.on("focus.focus",w).off("blur.focus"))}function w(){k&&(k=!1,B.stop().fadeTo("fast",1).on("mouseleave.focus",y).off("mouseenter.focus"),Q.on("blur.focus",y).off("focus.focus"))}function b(t){t.altKey&&t.shiftKey&&87===t.keyCode&&u()}var x,A,k,D,U,M,z,O,j,q,S,E=e(document.body),C=e("#wpcontent"),T=e("#post-body-content"),L=e("#title"),P=e("#content"),W=e(document.createElement("DIV")),B=e("#edit-slug-box"),Q=B.find("a").add(B.find("button")).add(B.find("input")),H=e("#adminmenuwrap"),F=e(),I=e(),R="on"===t.getUserSetting("editor_expand","on"),N=!!R&&"on"===t.getUserSetting("post_dfw"),J=0,V=0,$=20;E.append(W),W.css({display:"none",position:"fixed",top:n.height(),right:0,bottom:0,left:0,"z-index":9997}),T.css({position:"relative"}),s.on("mousemove.focus",function(t){z=t.pageY}),e("#postdivrich").hasClass("wp-editor-expand")&&P.on("keydown.focus-shortcut",b),r.on("tinymce-editor-setup.focus",function(t,e){e.addButton("dfw",{active:N,classes:"wp-dfw btn widget",disabled:!R,onclick:u,onPostRender:function(){var t=this;r.on("dfw-activate.focus",function(){t.disabled(!1)}).on("dfw-deactivate.focus",function(){t.disabled(!0)}).on("dfw-on.focus",function(){t.active(!0)}).on("dfw-off.focus",function(){t.active(!1)})},tooltip:"Distraction-free writing mode",shortcut:"Alt+Shift+W"}),e.addCommand("wpToggleDFW",u),e.addShortcut("access+w","","wpToggleDFW")}),r.on("tinymce-editor-init.focus",function(t,s){function n(){S=!0}function a(){S=!1}var o,h;"content"===s.id&&(F=e(s.getWin()),I=e(s.getContentAreaContainer()).find("iframe"),o=function(){s.on("keydown",m),s.on("blur",f),s.on("focus",n),s.on("blur",a),s.on("wp-autoresize",i)},h=function(){s.off("keydown",m),s.off("blur",f),s.off("focus",n),s.off("blur",a),s.off("wp-autoresize",i)},N&&o(),r.on("dfw-on.focus",o).on("dfw-off.focus",h),s.on("click",function(t){t.target===s.getDoc().documentElement&&s.focus()}))}),r.on("quicktags-init",function(t,i){var s;i.settings.buttons&&-1!==(","+i.settings.buttons+",").indexOf(",dfw,")&&(s=e("#"+i.name+"_dfw"),e(document).on("dfw-activate",function(){s.prop("disabled",!1)}).on("dfw-deactivate",function(){s.prop("disabled",!0)}).on("dfw-on",function(){s.addClass("active")}).on("dfw-off",function(){s.removeClass("active")}))}),r.on("editor-expand-on.focus",o).on("editor-expand-off.focus",h),N&&(P.on("keydown.focus",m),L.add(P).on("blur.focus",f)),t.wp=t.wp||{},t.wp.editor=t.wp.editor||{},t.wp.editor.dfw={activate:o,deactivate:h,isActive:d,on:c,off:l,toggle:u,isOn:p}})}(window,window.jQuery);