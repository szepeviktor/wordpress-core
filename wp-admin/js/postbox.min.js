!function(t){var e=t(document);window.postboxes={handle_click:function(){var i,s=t(this),r=s.parent(".postbox"),n=r.attr("id");"dashboard_browser_nag"!==n&&(r.toggleClass("closed"),i=!r.hasClass("closed"),s.hasClass("handlediv")?s.attr("aria-expanded",i):s.closest(".postbox").find("button.handlediv").attr("aria-expanded",i),"press-this"!==postboxes.page&&postboxes.save_state(postboxes.page),n&&(!r.hasClass("closed")&&t.isFunction(postboxes.pbshow)?postboxes.pbshow(n):r.hasClass("closed")&&t.isFunction(postboxes.pbhide)&&postboxes.pbhide(n)),e.trigger("postbox-toggled",r))},add_postbox_toggles:function(i,s){var r=t(".postbox .hndle, .postbox .handlediv");this.page=i,this.init(i,s),r.on("click.postboxes",this.handle_click),t(".postbox .hndle a").click(function(t){t.stopPropagation()}),t(".postbox a.dismiss").on("click.postboxes",function(e){var i=t(this).parents(".postbox").attr("id")+"-hide";e.preventDefault(),t("#"+i).prop("checked",!1).triggerHandler("click")}),t(".hide-postbox-tog").bind("click.postboxes",function(){var s=t(this),r=s.val(),n=t("#"+r);s.prop("checked")?(n.show(),t.isFunction(postboxes.pbshow)&&postboxes.pbshow(r)):(n.hide(),t.isFunction(postboxes.pbhide)&&postboxes.pbhide(r)),postboxes.save_state(i),postboxes._mark_area(),e.trigger("postbox-toggled",n)}),t('.columns-prefs input[type="radio"]').bind("click.postboxes",function(){var e=parseInt(t(this).val(),10);e&&(postboxes._pb_edit(e),postboxes.save_order(i))})},init:function(i,s){var r=t(document.body).hasClass("mobile"),n=t(".postbox .handlediv");t.extend(this,s||{}),t("#wpbody-content").css("overflow","hidden"),t(".meta-box-sortables").sortable({placeholder:"sortable-placeholder",connectWith:".meta-box-sortables",items:".postbox",handle:".hndle",cursor:"move",delay:r?200:0,distance:2,tolerance:"pointer",forcePlaceholderSize:!0,helper:function(t,e){return e.clone().find(":input").attr("name",function(t,e){return"sort_"+parseInt(1e5*Math.random(),10).toString()+"_"+e}).end()},opacity:.65,stop:function(){var e=t(this);if(e.find("#dashboard_browser_nag").is(":visible")&&"dashboard_browser_nag"!=this.firstChild.id)return void e.sortable("cancel");postboxes.save_order(i)},receive:function(i,s){"dashboard_browser_nag"==s.item[0].id&&t(s.sender).sortable("cancel"),postboxes._mark_area(),e.trigger("postbox-moved",s.item)}}),r&&(t(document.body).bind("orientationchange.postboxes",function(){postboxes._pb_change()}),this._pb_change()),this._mark_area(),n.each(function(){var e=t(this);e.attr("aria-expanded",!e.parent(".postbox").hasClass("closed"))})},save_state:function(e){var i,s;"nav-menus"!==e&&(i=t(".postbox").filter(".closed").map(function(){return this.id}).get().join(","),s=t(".postbox").filter(":hidden").map(function(){return this.id}).get().join(","),t.post(ajaxurl,{action:"closed-postboxes",closed:i,hidden:s,closedpostboxesnonce:jQuery("#closedpostboxesnonce").val(),page:e}))},save_order:function(e){var i,s=t(".columns-prefs input:checked").val()||0;i={action:"meta-box-order",_ajax_nonce:t("#meta-box-order-nonce").val(),page_columns:s,page:e},t(".meta-box-sortables").each(function(){i["order["+this.id.split("-")[0]+"]"]=t(this).sortable("toArray").join(",")}),t.post(ajaxurl,i)},_mark_area:function(){var e=t("div.postbox:visible").length,i=t("#post-body #side-sortables");t("#dashboard-widgets .meta-box-sortables:visible").each(function(){var i=t(this);1==e||i.children(".postbox:visible").length?i.removeClass("empty-container"):(i.addClass("empty-container"),i.attr("data-emptyString",postBoxL10n.postBoxEmptyString))}),i.length&&(i.children(".postbox:visible").length?i.removeClass("empty-container"):"280px"==t("#postbox-container-1").css("width")&&i.addClass("empty-container"))},_pb_edit:function(e){var i=t(".metabox-holder").get(0);i&&(i.className=i.className.replace(/columns-\d+/,"columns-"+e)),t(document).trigger("postboxes-columnchange")},_pb_change:function(){var e=t('label.columns-prefs-1 input[type="radio"]');switch(window.orientation){case 90:case-90:e.length&&e.is(":checked")||this._pb_edit(2);break;case 0:case 180:t("#poststuff").length?this._pb_edit(1):e.length&&e.is(":checked")||this._pb_edit(2)}},pbshow:!1,pbhide:!1}}(jQuery);