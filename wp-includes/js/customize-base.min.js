window.wp=window.wp||{},function(t,e){var i,s,r={},n=Array.prototype.slice;i=function(){},s=function(t,s,r){var n;return n=s&&s.hasOwnProperty("constructor")?s.constructor:function(){return t.apply(this,arguments)},e.extend(n,t),i.prototype=t.prototype,n.prototype=new i,s&&e.extend(n.prototype,s),r&&e.extend(n,r),n.prototype.constructor=n,n.__super__=t.prototype,n},r.Class=function(t,i,s){var n,a=arguments;return t&&i&&r.Class.applicator===t&&(a=i,e.extend(this,s||{})),n=this,this.instance&&(n=function(){return n.instance.apply(n,arguments)},e.extend(n,this)),n.initialize.apply(n,a),n},r.Class.extend=function(t,e){var i=s(this,t,e);return i.extend=this.extend,i},r.Class.applicator={},r.Class.prototype.initialize=function(){},r.Class.prototype.extended=function(t){for(var e=this;"undefined"!=typeof e.constructor;){if(e.constructor===t)return!0;if("undefined"==typeof e.constructor.__super__)return!1;e=e.constructor.__super__}return!1},r.Events={trigger:function(t){return this.topics&&this.topics[t]&&this.topics[t].fireWith(this,n.call(arguments,1)),this},bind:function(t){return this.topics=this.topics||{},this.topics[t]=this.topics[t]||e.Callbacks(),this.topics[t].add.apply(this.topics[t],n.call(arguments,1)),this},unbind:function(t){return this.topics&&this.topics[t]&&this.topics[t].remove.apply(this.topics[t],n.call(arguments,1)),this}},r.Value=r.Class.extend({initialize:function(t,i){this._value=t,this.callbacks=e.Callbacks(),this._dirty=!1,e.extend(this,i||{}),this.set=e.proxy(this.set,this)},instance:function(){return arguments.length?this.set.apply(this,arguments):this.get()},get:function(){return this._value},set:function(t){var e=this._value;return t=this._setter.apply(this,arguments),null===(t=this.validate(t))||_.isEqual(e,t)?this:(this._value=t,this._dirty=!0,this.callbacks.fireWith(this,[t,e]),this)},_setter:function(t){return t},setter:function(t){var e=this.get();return this._setter=t,this._value=null,this.set(e),this},resetSetter:function(){return this._setter=this.constructor.prototype._setter,this.set(this.get()),this},validate:function(t){return t},bind:function(){return this.callbacks.add.apply(this.callbacks,arguments),this},unbind:function(){return this.callbacks.remove.apply(this.callbacks,arguments),this},link:function(){var t=this.set;return e.each(arguments,function(){this.bind(t)}),this},unlink:function(){var t=this.set;return e.each(arguments,function(){this.unbind(t)}),this},sync:function(){var t=this;return e.each(arguments,function(){t.link(this),this.link(t)}),this},unsync:function(){var t=this;return e.each(arguments,function(){t.unlink(this),this.unlink(t)}),this}}),r.Values=r.Class.extend({defaultConstructor:r.Value,initialize:function(t){e.extend(this,t||{}),this._value={},this._deferreds={}},instance:function(t){return 1===arguments.length?this.value(t):this.when.apply(this,arguments)},value:function(t){return this._value[t]},has:function(t){return"undefined"!=typeof this._value[t]},add:function(t,e){var i,s,n=this;if("string"==typeof t)i=t,s=e;else{if("string"!=typeof t.id)throw new Error("Unknown key");i=t.id,s=t}return n.has(i)?n.value(i):(n._value[i]=s,s.parent=n,s.extended(r.Value)&&s.bind(n._change),n.trigger("add",s),n._deferreds[i]&&n._deferreds[i].resolve(),n._value[i])},create:function(t){return this.add(t,new this.defaultConstructor(r.Class.applicator,n.call(arguments,1)))},each:function(t,i){i=void 0===i?this:i,e.each(this._value,function(e,s){t.call(i,s,e)})},remove:function(t){var e=this.value(t);e&&(this.trigger("remove",e),e.extended(r.Value)&&e.unbind(this._change),delete e.parent),delete this._value[t],delete this._deferreds[t],e&&this.trigger("removed",e)},when:function(){var t=this,i=n.call(arguments),s=e.Deferred();return e.isFunction(i[i.length-1])&&s.done(i.pop()),e.when.apply(e,e.map(i,function(i){if(!t.has(i))return t._deferreds[i]=t._deferreds[i]||e.Deferred()})).done(function(){var r=e.map(i,function(e){return t(e)});if(r.length!==i.length)return void t.when.apply(t,i).done(function(){s.resolveWith(t,r)});s.resolveWith(t,r)}),s.promise()},_change:function(){this.parent.trigger("change",this)}}),e.extend(r.Values.prototype,r.Events),r.ensure=function(t){return"string"==typeof t?e(t):t},r.Element=r.Value.extend({initialize:function(t,i){var s,n,a,o=this,h=r.Element.synchronizer.html;this.element=r.ensure(t),this.events="",this.element.is("input, select, textarea")&&(s=this.element.prop("type"),this.events+=" change input",h=r.Element.synchronizer.val,this.element.is("input")&&r.Element.synchronizer[s]&&(h=r.Element.synchronizer[s])),r.Value.prototype.initialize.call(this,null,e.extend(i||{},h)),this._value=this.get(),n=this.update,a=this.refresh,this.update=function(t){t!==a.call(o)&&n.apply(this,arguments)},this.refresh=function(){o.set(a.call(o))},this.bind(this.update),this.element.bind(this.events,this.refresh)},find:function(t){return e(t,this.element)},refresh:function(){},update:function(){}}),r.Element.synchronizer={},e.each(["html","val"],function(t,e){r.Element.synchronizer[e]={update:function(t){this.element[e](t)},refresh:function(){return this.element[e]()}}}),r.Element.synchronizer.checkbox={update:function(t){this.element.prop("checked",t)},refresh:function(){return this.element.prop("checked")}},r.Element.synchronizer.radio={update:function(t){this.element.filter(function(){return this.value===t}).prop("checked",!0)},refresh:function(){return this.element.filter(":checked").val()}},e.support.postMessage=!!window.postMessage,r.Messenger=r.Class.extend({add:function(t,e,i){return this[t]=new r.Value(e,i)},initialize:function(t,i){var s=window.parent===window?null:window.parent;e.extend(this,i||{}),this.add("channel",t.channel),this.add("url",t.url||""),this.add("origin",this.url()).link(this.url).setter(function(t){var e=document.createElement("a");return e.href=t,e.protocol+"//"+e.host.replace(/:(80|443)$/,"")}),this.add("targetWindow",null),this.targetWindow.set=function(t){var e=this._value;return t=this._setter.apply(this,arguments),null===(t=this.validate(t))||e===t?this:(this._value=t,this._dirty=!0,this.callbacks.fireWith(this,[t,e]),this)},this.targetWindow(t.targetWindow||s),this.receive=e.proxy(this.receive,this),this.receive.guid=e.guid++,e(window).on("message",this.receive)},destroy:function(){e(window).off("message",this.receive)},receive:function(t){var e;t=t.originalEvent,this.targetWindow&&this.targetWindow()&&(this.origin()&&t.origin!==this.origin()||"string"==typeof t.data&&"{"===t.data[0]&&(e=JSON.parse(t.data))&&e.id&&"undefined"!=typeof e.data&&((e.channel||this.channel())&&this.channel()!==e.channel||this.trigger(e.id,e.data)))},send:function(t,e){var i;e=void 0===e?null:e,this.url()&&this.targetWindow()&&(i={id:t,data:e},this.channel()&&(i.channel=this.channel()),this.targetWindow().postMessage(JSON.stringify(i),this.origin()))}}),e.extend(r.Messenger.prototype,r.Events),r.Notification=r.Class.extend({template:null,templateId:"customize-notification",containerClasses:"",initialize:function(t,e){var i;this.code=t,i=_.extend({message:null,type:"error",fromServer:!1,data:null,setting:null,template:null,dismissible:!1,containerClasses:""},e),delete i.code,_.extend(this,i)},render:function(){var t,i,s=this;return s.template||(s.template=wp.template(s.templateId)),i=_.extend({},s,{alt:s.parent&&s.parent.alt}),t=e(s.template(i)),s.dismissible&&t.find(".notice-dismiss").on("click keydown",function(e){"keydown"===e.type&&13!==e.which||(s.parent?s.parent.remove(s.code):t.remove())}),t}}),r=e.extend(new r.Values,r),r.get=function(){var t={};return this.each(function(e,i){t[i]=e.get()}),t},r.utils={},r.utils.parseQueryString=function(t){var e={};return _.each(t.split("&"),function(t){var i,s,r;i=t.split("=",2),i[0]&&(s=decodeURIComponent(i[0].replace(/\+/g," ")),s=s.replace(/ /g,"_"),r=_.isUndefined(i[1])?null:decodeURIComponent(i[1].replace(/\+/g," ")),e[s]=r)}),e},t.customize=r}(wp,jQuery);