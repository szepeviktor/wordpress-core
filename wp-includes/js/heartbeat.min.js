!function(t,e,i){var s=function(){function s(){return(new Date).getTime()}function r(t){var i,s=t.src;if(s&&/^https?:\/\//.test(s)&&(i=e.location.origin?e.location.origin:e.location.protocol+"//"+e.location.host,0!==s.indexOf(i)))return!1;try{if(t.contentWindow.document)return!0}catch(r){}return!1}function n(){k.hasFocus&&!document.hasFocus()?c():!k.hasFocus&&document.hasFocus()&&l()}function a(t,e){var i;if(t){switch(t){case"abort":break;case"timeout":i=!0;break;case"error":if(503===e&&k.hasConnected){i=!0;break}case"parsererror":case"empty":case"unknown":k.errorcount++,k.errorcount>2&&k.hasConnected&&(i=!0)}i&&!g()&&(k.connectionError=!0,A.trigger("heartbeat-connection-lost",[t,e]))}}function o(){k.hasConnected=!0,g()&&(k.errorcount=0,k.connectionError=!1,A.trigger("heartbeat-connection-restored"))}function h(){var i,r;k.connecting||k.suspend||(k.lastTick=s(),r=t.extend({},k.queue),k.queue={},A.trigger("heartbeat-send",[r]),i={data:r,interval:k.tempInterval?k.tempInterval/1e3:k.mainInterval/1e3,_nonce:"object"==typeof e.heartbeatSettings?e.heartbeatSettings.nonce:"",action:"heartbeat",screen_id:k.screenId,has_focus:k.hasFocus},"customize"===k.screenId&&(i.wp_customize="on"),k.connecting=!0,k.xhr=t.ajax({url:k.url,type:"post",timeout:3e4,data:i,dataType:"json"}).always(function(){k.connecting=!1,d()}).done(function(t,e,i){var s;if(!t)return void a("empty");o(),t.nonces_expired&&A.trigger("heartbeat-nonces-expired"),t.heartbeat_interval&&(s=t.heartbeat_interval,delete t.heartbeat_interval),A.trigger("heartbeat-tick",[t,e,i]),s&&v(s)}).fail(function(t,e,i){a(e||"unknown",t.status),A.trigger("heartbeat-error",[t,e,i])}))}function d(){var t=s()-k.lastTick,i=k.mainInterval;k.suspend||(k.hasFocus?k.countdown>0&&k.tempInterval&&(i=k.tempInterval,--k.countdown<1&&(k.tempInterval=0)):i=12e4,k.minimalInterval&&i<k.minimalInterval&&(i=k.minimalInterval),e.clearTimeout(k.beatTimer),t<i?k.beatTimer=e.setTimeout(function(){h()},i-t):h())}function c(){k.hasFocus=!1}function l(){k.userActivity=s(),k.suspend=!1,k.hasFocus||(k.hasFocus=!0,d())}function u(){k.userActivityEvents=!1,A.off(".wp-heartbeat-active"),t("iframe").each(function(e,i){r(i)&&t(i.contentWindow).off(".wp-heartbeat-active")}),l()}function p(){var e=k.userActivity?s()-k.userActivity:0;e>3e5&&k.hasFocus&&c(),(k.suspendEnabled&&e>6e5||e>36e5)&&(k.suspend=!0),k.userActivityEvents||(A.on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){u()}),t("iframe").each(function(e,i){r(i)&&t(i.contentWindow).on("mouseover.wp-heartbeat-active keyup.wp-heartbeat-active touchend.wp-heartbeat-active",function(){u()})}),k.userActivityEvents=!0)}function m(){return k.hasFocus}function g(){return k.connectionError}function f(){k.lastTick=0,d()}function _(){k.suspendEnabled=!1}function v(t,e){var i,s=k.tempInterval?k.tempInterval:k.mainInterval;if(t){switch(t){case"fast":case 5:i=5e3;break;case 15:i=15e3;break;case 30:i=3e4;break;case 60:i=6e4;break;case 120:i=12e4;break;case"long-polling":return k.mainInterval=0,0;default:i=k.originalInterval}k.minimalInterval&&i<k.minimalInterval&&(i=k.minimalInterval),5e3===i?(e=parseInt(e,10)||30,e=e<1||e>30?30:e,k.countdown=e,k.tempInterval=i):(k.countdown=0,k.tempInterval=0,k.mainInterval=i),i!==s&&d()}return k.tempInterval?k.tempInterval/1e3:k.mainInterval/1e3}function y(t,e,i){return!!t&&((!i||!this.isQueued(t))&&(k.queue[t]=e,!0))}function w(t){if(t)return k.queue.hasOwnProperty(t)}function b(t){t&&delete k.queue[t]}function x(t){if(t)return this.isQueued(t)?k.queue[t]:i}var A=t(document),k={suspend:!1,suspendEnabled:!0,screenId:"",url:"",lastTick:0,queue:{},mainInterval:60,tempInterval:0,originalInterval:0,minimalInterval:0,countdown:0,connecting:!1,connectionError:!1,errorcount:0,hasConnected:!1,hasFocus:!0,userActivity:0,userActivityEvents:!1,checkFocusTimer:0,beatTimer:0};return function(){var i,r,a,o;"string"==typeof e.pagenow&&(k.screenId=e.pagenow),"string"==typeof e.ajaxurl&&(k.url=e.ajaxurl),"object"==typeof e.heartbeatSettings&&(i=e.heartbeatSettings,!k.url&&i.ajaxurl&&(k.url=i.ajaxurl),i.interval&&(k.mainInterval=i.interval,k.mainInterval<15?k.mainInterval=15:k.mainInterval>120&&(k.mainInterval=120)),i.minimalInterval&&(i.minimalInterval=parseInt(i.minimalInterval,10),k.minimalInterval=i.minimalInterval>0&&i.minimalInterval<=600?1e3*i.minimalInterval:0),k.minimalInterval&&k.mainInterval<k.minimalInterval&&(k.mainInterval=k.minimalInterval),k.screenId||(k.screenId=i.screenId||"front"),"disable"===i.suspension&&(k.suspendEnabled=!1)),k.mainInterval=1e3*k.mainInterval,k.originalInterval=k.mainInterval,"undefined"!=typeof document.hidden?(r="hidden",o="visibilitychange",a="visibilityState"):"undefined"!=typeof document.msHidden?(r="msHidden",o="msvisibilitychange",a="msVisibilityState"):"undefined"!=typeof document.webkitHidden&&(r="webkitHidden",o="webkitvisibilitychange",a="webkitVisibilityState"),r&&(document[r]&&(k.hasFocus=!1),A.on(o+".wp-heartbeat",function(){"hidden"===document[a]?(c(),e.clearInterval(k.checkFocusTimer)):(l(),document.hasFocus&&(k.checkFocusTimer=e.setInterval(n,1e4)))})),document.hasFocus&&(k.checkFocusTimer=e.setInterval(n,1e4)),t(e).on("unload.wp-heartbeat",function(){k.suspend=!0,k.xhr&&4!==k.xhr.readyState&&k.xhr.abort()}),e.setInterval(p,3e4),A.ready(function(){k.lastTick=s(),d()})}(),{hasFocus:m,connectNow:f,disableSuspend:_,interval:v,hasConnectionError:g,enqueue:y,dequeue:b,isQueued:w,getQueuedItem:x}};e.wp=e.wp||{},e.wp.heartbeat=new s}(jQuery,window);