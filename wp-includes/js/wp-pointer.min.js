!function(t){var e=0,i=9999;t.widget("wp.pointer",{options:{pointerClass:"wp-pointer",pointerWidth:320,content:function(){return t(this).text()},buttons:function(e,i){var s=wpPointerL10n?wpPointerL10n.dismiss:"Dismiss";return t('<a class="close" href="#">'+s+"</a>").bind("click.pointer",function(t){t.preventDefault(),i.element.pointer("close")})},position:"top",show:function(t,e){e.pointer.show(),e.opened()},hide:function(t,e){e.pointer.hide(),e.closed()},document:document},_create:function(){var i,s;this.content=t('<div class="wp-pointer-content"></div>'),this.arrow=t('<div class="wp-pointer-arrow"><div class="wp-pointer-arrow-inner"></div></div>'),s=this.element.parents().add(this.element),i="absolute",s.filter(function(){return"fixed"===t(this).css("position")}).length&&(i="fixed"),this.pointer=t("<div />").append(this.content).append(this.arrow).attr("id","wp-pointer-"+e++).addClass(this.options.pointerClass).css({position:i,width:this.options.pointerWidth+"px",display:"none"}).appendTo(this.options.document.body)},_setOption:function(e,i){var s=this.options,r=this.pointer;"document"===e&&i!==s.document?r.detach().appendTo(i.body):"pointerClass"===e&&r.removeClass(s.pointerClass).addClass(i),t.Widget.prototype._setOption.apply(this,arguments),"position"===e?this.reposition():"content"===e&&this.active&&this.update()},destroy:function(){this.pointer.remove(),t.Widget.prototype.destroy.call(this)},widget:function(){return this.pointer},update:function(e){var i,s=this,r=this.options,n=t.Deferred();if(!r.disabled)return n.done(function(t){s._update(e,t)}),i="string"==typeof r.content?r.content:r.content.call(this.element[0],n.resolve,e,this._handoff()),i&&n.resolve(i),n.promise()},_update:function(t,e){var i,s=this.options;e&&(this.pointer.stop(),this.content.html(e),i=s.buttons.call(this.element[0],t,this._handoff()),i&&i.wrap('<div class="wp-pointer-buttons" />').parent().appendTo(this.content),this.reposition())},reposition:function(){var e;this.options.disabled||(e=this._processPosition(this.options.position),this.pointer.css({top:0,left:0,zIndex:i++}).show().position(t.extend({of:this.element,collision:"fit none"},e)),this.repoint())},repoint:function(){var t,e=this.options;e.disabled||(t="string"==typeof e.position?e.position:e.position.edge,this.pointer[0].className=this.pointer[0].className.replace(/wp-pointer-[^\s'"]*/,""),this.pointer.addClass("wp-pointer-"+t))},_processPosition:function(e){var i,s={top:"bottom",bottom:"top",left:"right",right:"left"};return i="string"==typeof e?{edge:e+""}:t.extend({},e),i.edge?("top"==i.edge||"bottom"==i.edge?(i.align=i.align||"left",i.at=i.at||i.align+" "+s[i.edge],i.my=i.my||i.align+" "+i.edge):(i.align=i.align||"top",i.at=i.at||s[i.edge]+" "+i.align,i.my=i.my||i.edge+" "+i.align),i):i},open:function(t){var e=this,i=this.options;this.active||i.disabled||this.element.is(":hidden")||this.update().done(function(){e._open(t)})},_open:function(t){var e=this,i=this.options;this.active||i.disabled||this.element.is(":hidden")||(this.active=!0,this._trigger("open",t,this._handoff()),this._trigger("show",t,this._handoff({opened:function(){e._trigger("opened",t,e._handoff())}})))},close:function(t){if(this.active&&!this.options.disabled){var e=this;this.active=!1,this._trigger("close",t,this._handoff()),this._trigger("hide",t,this._handoff({closed:function(){e._trigger("closed",t,e._handoff())}}))}},sendToTop:function(){this.active&&this.pointer.css("z-index",i++)},toggle:function(t){this.pointer.is(":hidden")?this.open(t):this.close(t)},_handoff:function(e){return t.extend({pointer:this.pointer,element:this.element},e)}})}(jQuery);