!function(t){var e,i={add:"ajaxAdd",del:"ajaxDel",dim:"ajaxDim",process:"process",recolor:"recolor"};e={settings:{url:ajaxurl,type:"POST",response:"ajax-response",what:"",alt:"alternate",altOffset:0,addColor:"#ffff33",delColor:"#faafaa",dimAddColor:"#ffff33",dimDelColor:"#ff3333",confirm:null,addBefore:null,addAfter:null,delBefore:null,delAfter:null,dimBefore:null,dimAfter:null},nonce:function(e,i){var s=wpAjax.unserialize(e.attr("href")),r=t("#"+i.element);return i.nonce||s._ajax_nonce||r.find('input[name="_ajax_nonce"]').val()||s._wpnonce||r.find('input[name="_wpnonce"]').val()||0},parseData:function(e,i){var s,r=[];try{s=t(e).data("wp-lists")||"",s=s.match(new RegExp(i+":[\\S]+")),s&&(r=s[0].split(":"))}catch(n){}return r},pre:function(e,i,s){var r,n,a;return i=t.extend({},this.wpList.settings,{element:null,nonce:0,target:e.get(0)},i||{}),!(t.isFunction(i.confirm)&&(r=t("#"+i.element),"add"!==s&&(n=r.css("backgroundColor"),r.css("backgroundColor","#ff9966")),a=i.confirm.call(this,e,i,s,n),"add"!==s&&r.css("backgroundColor",n),!a))&&i},ajaxAdd:function(i,s){var r,n,a,o,h=this,d=t(i),c=e.parseData(d,"add");return s=s||{},s=e.pre.call(h,d,s,"add"),s.element=c[2]||d.prop("id")||s.element||null,s.addColor=c[3]?"#"+c[3]:s.addColor,!!s&&(d.is('[id="'+s.element+'-submit"]')?!s.element||(s.action="add-"+s.what,s.nonce=e.nonce(d,s),!!wpAjax.validateForm("#"+s.element)&&(s.data=t.param(t.extend({_ajax_nonce:s.nonce,action:s.action},wpAjax.unserialize(c[4]||""))),r=t("#"+s.element+" :input").not('[name="_ajax_nonce"], [name="_wpnonce"], [name="action"]'),n=t.isFunction(r.fieldSerialize)?r.fieldSerialize():r.serialize(),n&&(s.data+="&"+n),!(!t.isFunction(s.addBefore)||(s=s.addBefore(s)))||(!s.data.match(/_ajax_nonce=[a-f0-9]+/)||(s.success=function(i){return a=wpAjax.parseAjaxResponse(i,s.response,s.element),o=i,!(!a||a.errors)&&(!0===a||(t.each(a.responses,function(){e.add.call(h,this.data,t.extend({},s,{position:this.position||0,id:this.id||0,oldId:this.oldId||null}))}),h.wpList.recolor(),t(h).trigger("wpListAddEnd",[s,h.wpList]),void e.clear.call(h,"#"+s.element)))},s.complete=function(e,i){t.isFunction(s.addAfter)&&s.addAfter(o,t.extend({xml:e,status:i,parsed:a},s))},t.ajax(s),!1)))):!e.add.call(h,d,s))},ajaxDel:function(i,s){var r,n,a,o=this,h=t(i),d=e.parseData(h,"delete");return s=s||{},s=e.pre.call(o,h,s,"delete"),s.element=d[2]||s.element||null,s.delColor=d[3]?"#"+d[3]:s.delColor,!(!s||!s.element)&&(s.action="delete-"+s.what,s.nonce=e.nonce(h,s),s.data=t.extend({_ajax_nonce:s.nonce,action:s.action,id:s.element.split("-").pop()},wpAjax.unserialize(d[4]||"")),!(!t.isFunction(s.delBefore)||(s=s.delBefore(s,o)))||(!s.data._ajax_nonce||(r=t("#"+s.element),"none"!==s.delColor?r.css("backgroundColor",s.delColor).fadeOut(350,function(){o.wpList.recolor(),t(o).trigger("wpListDelEnd",[s,o.wpList])}):(o.wpList.recolor(),t(o).trigger("wpListDelEnd",[s,o.wpList])),s.success=function(e){if(n=wpAjax.parseAjaxResponse(e,s.response,s.element),a=e,!n||n.errors)return r.stop().stop().css("backgroundColor","#faa").show().queue(function(){o.wpList.recolor(),t(this).dequeue()}),!1},s.complete=function(e,i){t.isFunction(s.delAfter)&&r.queue(function(){s.delAfter(a,t.extend({xml:e,status:i,parsed:n},s))}).dequeue()},t.ajax(s),!1)))},ajaxDim:function(i,s){var r,n,a,o,h,d,c=this,l=t(i),u=e.parseData(l,"dim");return"none"!==l.parent().css("display")&&(s=s||{},s=e.pre.call(c,l,s,"dim"),s.element=u[2]||s.element||null,s.dimClass=u[3]||s.dimClass||null,s.dimAddColor=u[4]?"#"+u[4]:s.dimAddColor,s.dimDelColor=u[5]?"#"+u[5]:s.dimDelColor,!(s&&s.element&&s.dimClass)||(s.action="dim-"+s.what,s.nonce=e.nonce(l,s),s.data=t.extend({_ajax_nonce:s.nonce,action:s.action,id:s.element.split("-").pop(),dimClass:s.dimClass},wpAjax.unserialize(u[6]||"")),!(!t.isFunction(s.dimBefore)||(s=s.dimBefore(s)))||(r=t("#"+s.element),n=r.toggleClass(s.dimClass).is("."+s.dimClass),a=e.getColor(r),o=n?s.dimAddColor:s.dimDelColor,r.toggleClass(s.dimClass),"none"!==o?r.animate({backgroundColor:o},"fast").queue(function(){r.toggleClass(s.dimClass),t(this).dequeue()}).animate({backgroundColor:a},{complete:function(){t(this).css("backgroundColor",""),t(c).trigger("wpListDimEnd",[s,c.wpList])}}):t(c).trigger("wpListDimEnd",[s,c.wpList]),!s.data._ajax_nonce||(s.success=function(e){if(h=wpAjax.parseAjaxResponse(e,s.response,s.element),d=e,!0===h)return!0;if(!h||h.errors)return r.stop().stop().css("backgroundColor","#ff3333")[n?"removeClass":"addClass"](s.dimClass).show().queue(function(){c.wpList.recolor(),t(this).dequeue()}),!1;if("undefined"!=typeof h.responses[0].supplemental.comment_link){var i=l.find(".submitted-on"),a=i.find("a");""!==h.responses[0].supplemental.comment_link?i.html(t("<a></a>").text(i.text()).prop("href",h.responses[0].supplemental.comment_link)):a.length&&i.text(a.text())}},s.complete=function(e,i){t.isFunction(s.dimAfter)&&r.queue(function(){s.dimAfter(d,t.extend({xml:e,status:i,parsed:h},s))}).dequeue()},t.ajax(s),!1))))},getColor:function(e){return t(e).css("backgroundColor")||"#ffffff"},add:function(i,s){var r,n,a=t(this),o=t(i),h=!1;return"string"==typeof s&&(s={what:s}),s=t.extend({position:0,id:0,oldId:null},this.wpList.settings,s),!(!o.length||!s.what)&&(s.oldId&&(h=t("#"+s.what+"-"+s.oldId)),!s.id||s.id===s.oldId&&h&&h.length||t("#"+s.what+"-"+s.id).remove(),h&&h.length?(h.before(o),h.remove()):isNaN(s.position)?(r="after","-"===s.position.substr(0,1)&&(s.position=s.position.substr(1),r="before"),n=a.find("#"+s.position),1===n.length?n[r](o):a.append(o)):"comment"===s.what&&0!==t("#"+s.element).length||(s.position<0?a.prepend(o):a.append(o)),s.alt&&o.toggleClass(s.alt,(a.children(":visible").index(o[0])+s.altOffset)%2),"none"!==s.addColor&&o.css("backgroundColor",s.addColor).animate({backgroundColor:e.getColor(o)},{complete:function(){t(this).css("backgroundColor","")}}),a.each(function(t,e){e.wpList.process(o)}),o)},clear:function(e){var i,s,r=this,n=t(e);r.wpList&&n.parents("#"+r.id).length||n.find(":input").each(function(e,r){t(r).parents(".form-no-clear").length||(i=r.type.toLowerCase(),s=r.tagName.toLowerCase(),"text"===i||"password"===i||"textarea"===s?r.value="":"checkbox"===i||"radio"===i?r.checked=!1:"select"===s&&(r.selectedIndex=null))})},process:function(e){var i=this,s=t(e||document);s.on("submit",'form[data-wp-lists^="add:'+i.id+':"]',function(){return i.wpList.add(this)}),s.on("click",'a[data-wp-lists^="add:'+i.id+':"], input[data-wp-lists^="add:'+i.id+':"]',function(){return i.wpList.add(this)}),s.on("click",'[data-wp-lists^="delete:'+i.id+':"]',function(){return i.wpList.del(this)}),s.on("click",'[data-wp-lists^="dim:'+i.id+':"]',function(){return i.wpList.dim(this)})},recolor:function(){var e,i=this,s=[":even",":odd"];i.wpList.settings.alt&&(e=t(".list-item:visible",i),e.length||(e=t(i).children(":visible")),i.wpList.settings.altOffset%2&&s.reverse(),e.filter(s[0]).addClass(i.wpList.settings.alt).end(),e.filter(s[1]).removeClass(i.wpList.settings.alt))},init:function(){var t=this;t.wpList.process=function(e){t.each(function(){this.wpList.process(e)})},t.wpList.recolor=function(){t.each(function(){this.wpList.recolor()})}}},t.fn.wpList=function(s){return this.each(function(r,n){n.wpList={settings:t.extend({},e.settings,{what:e.parseData(n,"list")[1]||""},s)},t.each(i,function(t,i){n.wpList[t]=function(t,s){return e[i].call(n,t,s)}})}),e.init.call(this),this.wpList.process(),this}}(jQuery);